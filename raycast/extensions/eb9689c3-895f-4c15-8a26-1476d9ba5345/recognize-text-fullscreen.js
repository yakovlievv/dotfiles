"use strict";var w=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var k=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var E=(t,e)=>{for(var r in e)w(t,r,{get:e[r],enumerable:!0})},J=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of k(e))!U.call(t,a)&&a!==r&&w(t,a,{get:()=>e[a],enumerable:!(n=C(e,a))||n.enumerable});return t};var j=t=>J(w({},"__esModule",{value:!0}),t);var N={};E(N,{default:()=>B});module.exports=j(N);var m=require("@raycast/api");var y=require("@raycast/api"),S=require("path"),x=require("fs/promises"),T=require("child_process");async function I(t,...e){if(process.platform==="win32")return Promise.reject(new Error("Swift functions are not supported on Windows"));let r=(0,S.join)(y.environment.assetsPath,"compiled_raycast_swift/swift");return await(0,x.chmod)(r,"755"),new Promise((n,a)=>{let c=[t];for(let i of e)try{c.push(JSON.stringify(i,(o,d)=>d===void 0?null:d))}catch(o){a(new g("Failed to serialize input to JSON: "+o.message));return}let u=(0,T.spawn)(r,c),l=[],p=[];u.stdout?.on("data",i=>{l.push(i.toString())}),u.stderr?.on("data",i=>{p.push(i.toString())}),u.on("exit",i=>{if(i===0)try{let o=l.join("").trim();o.length!=0?n(JSON.parse(o)):n(null)}catch(o){let d=new g("Failed to deserialize result from JSON: "+o.message);d.stdout=l.join("").trim(),d.stderr=p.join("").trim(),a(d)}else{let o=new g(p.join("").trim()||l.join("").trim()||"Could not get any data");o.stdout=l.join("").trim(),o.stderr=p.join("").trim(),a(o)}}),u.on("error",i=>{a(i)})})}async function L(t,e,r,n,a,c,u,l){return await I("recognizeText",t,e,r,n,a,c,u,l)}var g=class extends Error{constructor(e){super(e),this.name="SwiftError"}};var f=require("@raycast/api");var v=[{title:"\u{1F1FA}\u{1F1F8} English (US)",value:"en-US"},{title:"\u{1F1EB}\u{1F1F7} French (France)",value:"fr-FR"},{title:"\u{1F1EE}\u{1F1F9} Italian (Italy)",value:"it-IT"},{title:"\u{1F1E9}\u{1F1EA} German (Germany)",value:"de-DE"},{title:"\u{1F1EA}\u{1F1F8} Spanish (Spain)",value:"es-ES"},{title:"\u{1F1E7}\u{1F1F7} Portuguese (Brazil)",value:"pt-BR"},{title:"\u{1F1E8}\u{1F1F3} Chinese (Simplified)",value:"zh-Hans"},{title:"\u{1F1F9}\u{1F1FC} Chinese (Traditional)",value:"zh-Hant"},{title:"\u{1F1E8}\u{1F1F3} Cantonese (Simplified)",value:"yue-Hans"},{title:"\u{1F1ED}\u{1F1F0} Cantonese (Traditional)",value:"yue-Hant"},{title:"\u{1F1F0}\u{1F1F7} Korean (South Korea)",value:"ko-KR"},{title:"\u{1F1EF}\u{1F1F5} Japanese (Japan)",value:"ja-JP"},{title:"\u{1F1F7}\u{1F1FA} Russian (Russia)",value:"ru-RU"},{title:"\u{1F1FA}\u{1F1E6} Ukrainian (Ukraine)",value:"uk-UA"},{title:"\u{1F1F9}\u{1F1ED} Thai (Thailand)",value:"th-TH"},{title:"\u{1F1FB}\u{1F1F3} Vietnamese (Vietnam)",value:"vi-VT"}];var z=async()=>{let t=(0,f.getPreferenceValues)(),e=await f.LocalStorage.getItem("SelectedLanguages"),r={title:v.find(c=>c.value===t.primaryLanguage)?.title??"\u{1F1FA}\u{1F1F8} English (US)",value:t.primaryLanguage,isDefault:!0},n=[];return typeof e<"u"?(n=JSON.parse(e),n):[r]};var s=require("@raycast/api"),P=async(t=!1)=>{let e=(0,s.getPreferenceValues)();try{let r=await z();return await L(t,e.keepImage,e.ocrMode==="fast",e.languageCorrection,e.ignoreLineBreaks,e.customWordsList?e.customWordsList.split(","):[],r.map(a=>a.value),!!e.playSound)}catch(r){throw console.error(r),new Error("Failed to recognize text")}};var F=async t=>{(0,s.getPreferenceValues)().showToast&&await(0,s.showToast)({style:s.Toast.Style.Success,title:t})},h=async t=>{(0,s.getPreferenceValues)().showToast&&await(0,s.showToast)({style:s.Toast.Style.Failure,title:t})};async function B(){await(0,m.closeMainWindow)();try{let t=await P(!0);if(!t){await h("No text detected");return}await m.Clipboard.copy(t),await F("Copied text to clipboard")}catch(t){console.error(t),await h("Failed detecting text")}}
