"use strict";var M=Object.create;var b=Object.defineProperty;var W=Object.getOwnPropertyDescriptor;var D=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,N=Object.prototype.hasOwnProperty;var F=(e,t)=>{for(var r in t)b(e,r,{get:t[r],enumerable:!0})},v=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of D(t))!N.call(e,a)&&a!==r&&b(e,a,{get:()=>t[a],enumerable:!(i=W(t,a))||i.enumerable});return e};var k=(e,t,r)=>(r=e!=null?M(V(e)):{},v(t||!e||!e.__esModule?b(r,"default",{value:e,enumerable:!0}):r,e)),j=e=>v(b({},"__esModule",{value:!0}),e);var G={};F(G,{default:()=>z});module.exports=j(G);var w=require("@raycast/api");var S=require("@raycast/api"),E=require("path"),T=require("fs/promises"),R=require("child_process");async function B(e,...t){if(process.platform==="win32")return Promise.reject(new Error("Swift functions are not supported on Windows"));let r=(0,E.join)(S.environment.assetsPath,"compiled_raycast_swift","swift");return await(0,T.chmod)(r,"755"),new Promise((i,a)=>{let c=[e];for(let l of t)try{c.push(JSON.stringify(l,(o,p)=>p===void 0?null:p))}catch(o){a(new m("Failed to serialize input to JSON: "+o.message));return}let s=(0,R.spawn)(r,c),f=[],g=[];s.stdout?.on("data",l=>{f.push(l.toString())}),s.stderr?.on("data",l=>{g.push(l.toString())}),s.on("exit",l=>{if(l===0)try{let o=f.join("").trim();o.length!=0?i(JSON.parse(o)):i(null)}catch(o){let p=new m("Failed to deserialize result from JSON: "+o.message);p.stdout=f.join("").trim(),p.stderr=g.join("").trim(),a(p)}else{let o=new m(g.join("").trim()||f.join("").trim()||"Could not get any data");o.stdout=f.join("").trim(),o.stderr=g.join("").trim(),a(o)}}),s.on("error",l=>{a(l)})})}async function A(e,t,r,i,a,c,s,f){return await B("recognizeText",e,t,r,i,a,c,s,f)}var m=class extends Error{constructor(t){super(t),this.name="SwiftError"}};var $=require("@raycast/api");var P=[{title:"\u{1F1FA}\u{1F1F8} English (US)",value:"en-US"},{title:"\u{1F1EB}\u{1F1F7} French (France)",value:"fr-FR"},{title:"\u{1F1EE}\u{1F1F9} Italian (Italy)",value:"it-IT"},{title:"\u{1F1E9}\u{1F1EA} German (Germany)",value:"de-DE"},{title:"\u{1F1EA}\u{1F1F8} Spanish (Spain)",value:"es-ES"},{title:"\u{1F1E7}\u{1F1F7} Portuguese (Brazil)",value:"pt-BR"},{title:"\u{1F1E8}\u{1F1F3} Chinese (Simplified)",value:"zh-Hans"},{title:"\u{1F1F9}\u{1F1FC} Chinese (Traditional)",value:"zh-Hant"},{title:"\u{1F1E8}\u{1F1F3} Cantonese (Simplified)",value:"yue-Hans"},{title:"\u{1F1ED}\u{1F1F0} Cantonese (Traditional)",value:"yue-Hant"},{title:"\u{1F1F0}\u{1F1F7} Korean (South Korea)",value:"ko-KR"},{title:"\u{1F1EF}\u{1F1F5} Japanese (Japan)",value:"ja-JP"},{title:"\u{1F1F7}\u{1F1FA} Russian (Russia)",value:"ru-RU"},{title:"\u{1F1FA}\u{1F1E6} Ukrainian (Ukraine)",value:"uk-UA"},{title:"\u{1F1F9}\u{1F1ED} Thai (Thailand)",value:"th-TH"},{title:"\u{1F1FB}\u{1F1F3} Vietnamese (Vietnam)",value:"vi-VT"}];var U=async()=>{let e=(0,$.getPreferenceValues)(),t=await $.LocalStorage.getItem("SelectedLanguages"),r={title:P.find(c=>c.value===e.primaryLanguage)?.title??"\u{1F1FA}\u{1F1F8} English (US)",value:e.primaryLanguage,isDefault:!0},i=[];return typeof t<"u"&&(i=JSON.parse(t)),[...i,r]};var u=require("@raycast/api");var d=k(require("react")),n=require("@raycast/api");var h=k(require("node:fs")),y=k(require("node:path"));var C=require("react/jsx-runtime");function I(e,t){let r=e instanceof Error?e.message:String(e);return(0,n.showToast)({style:n.Toast.Style.Failure,title:t?.title??"Something went wrong",message:t?.message??r,primaryAction:t?.primaryAction??_(e),secondaryAction:t?.primaryAction?_(e):void 0})}var _=e=>{let t=!0,r="[Extension Name]...",i="";try{let s=JSON.parse((0,h.readFileSync)((0,y.join)(n.environment.assetsPath,"..","package.json"),"utf8"));r=`[${s.title}]...`,i=`https://raycast.com/${s.owner||s.author}/${s.name}`,(!s.owner||s.access==="public")&&(t=!1)}catch{}let a=n.environment.isDevelopment||t,c=e instanceof Error?e?.stack||e?.message||"":String(e);return{title:a?"Copy Logs":"Report Error",onAction(s){s.hide(),a?n.Clipboard.copy(c):(0,n.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(i)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${c}
\`\`\`
`)}`)}}};var O=async(e=!1)=>{let t=(0,u.getPreferenceValues)();try{let r=await U();return await A(e,t.keepImage,t.ocrMode==="fast",t.languageCorrection,t.ignoreLineBreaks,t.customWordsList?t.customWordsList.split(","):[],r.map(a=>a.value),!!t.playSound)}catch(r){throw console.error(r),new Error("Failed to recognize text")}};var L=async e=>{(0,u.getPreferenceValues)().showToast&&await(0,u.showToast)({style:u.Toast.Style.Success,title:e})},x=async(e,t)=>{(0,u.getPreferenceValues)().showToast&&await I(e,t)};async function z(){await(0,w.closeMainWindow)();try{let e=await O(!0);if(!e){await x("No text detected",{title:"No text detected"});return}await w.Clipboard.copy(e),await L("Copied text to clipboard")}catch(e){console.error(e),await x(e,{title:"Failed detecting text"})}}
