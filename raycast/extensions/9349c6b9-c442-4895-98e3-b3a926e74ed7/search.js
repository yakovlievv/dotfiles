"use strict";var Xa=Object.create;var Ct=Object.defineProperty;var Qa=Object.getOwnPropertyDescriptor;var es=Object.getOwnPropertyNames;var ts=Object.getPrototypeOf,rs=Object.prototype.hasOwnProperty;var H=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ns=(t,e)=>{for(var r in e)Ct(t,r,{get:e[r],enumerable:!0})},en=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of es(e))!rs.call(t,a)&&a!==r&&Ct(t,a,{get:()=>e[a],enumerable:!(n=Qa(e,a))||n.enumerable});return t};var R=(t,e,r)=>(r=t!=null?Xa(ts(t)):{},en(e||!t||!t.__esModule?Ct(r,"default",{value:t,enumerable:!0}):r,t)),as=t=>en(Ct({},"__esModule",{value:!0}),t);var or=H(Et=>{"use strict";Object.defineProperty(Et,"__esModule",{value:!0});Et.redactString=sr;Et.sanitizeArgs=$s;function wn(t){return t.replace(/([A-Za-z0-9._%+-])[^@\s]*(@[A-Za-z0-9.-]+\.[A-Za-z]{2,})/g,(e,r,n)=>`${r}***${n}`)}function sr(t){let e=t;return e=e.replace(/bearer\s+[^\s"']+/gi,"Bearer ***"),e=e.replace(/(password|pass|pwd|secret|token|auth|authorization|key)\s*[:=]\s*[^\s&"']+/gi,"$1=***"),e=e.replace(/((?:code|2fa|two[-\s]?factor|otp)\s*[:=\s]+)(\d{4,8})/gi,(r,n)=>`${n}******`),e=e.replace(/[a-f0-9]{32,}/gi,"***"),e=e.replace(/[A-Za-z0-9+/]{20,}={0,2}/g,"***"),e=wn(e),e}function kn(t,e){let r=t.toLowerCase();if(e==null)return e;if(typeof e=="string")return["password","pass","pwd","secret","token","auth","authorization","applepassword"].includes(r)?"***":["code","otp","2fa","twofactor","two_factor"].includes(r)?"******":["email","appleid","apple_id","username","user"].includes(r)?wn(e):sr(e);if(typeof e=="number")return["code","otp","2fa"].includes(r)?0:e;if(typeof e=="object")try{let n=JSON.stringify(e,(a,s)=>kn(a,s));return JSON.parse(n)}catch{return e}return e}function $s(t){return t.map(e=>{if(typeof e=="string")return sr(e);if(typeof e=="object"&&e!==null)try{let r=JSON.stringify(e,(n,a)=>kn(n,a));return JSON.parse(r)}catch{return e}return e})}});var _n=H(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.logger=We.Logger=void 0;var Ss=require("@raycast/api"),xn=or(),Tt=class t{constructor(e={}){this.config={isVerboseEnabled:e.isVerboseEnabled||this.defaultVerboseCheck,prefix:e.prefix||"",enableRedaction:e.enableRedaction??!0}}defaultVerboseCheck(){try{return(0,Ss.getPreferenceValues)().verboseLogging||!1}catch(e){return console.error("[Logger] Failed to read preferences for verbose logging:",e),!1}}static getInstance(){return t.instance||(t.instance=new t),t.instance}formatMessage(e){return this.config.prefix?`${this.config.prefix} ${e}`:e}processLogData(e,r){let n=this.formatMessage(e);return this.config.enableRedaction?[(0,xn.redactString)(n),(0,xn.sanitizeArgs)(r)]:[n,r]}log(e,...r){if(this.config.isVerboseEnabled()){let[n,a]=this.processLogData(e,r);console.log(n,...a)}}error(e,...r){let[n,a]=this.processLogData(e,r);console.error(n,...a)}warn(e,...r){let[n,a]=this.processLogData(e,r);console.warn(n,...a)}child(e){let r=this.config.prefix?`${this.config.prefix} ${e}`:e;return new t({...this.config,prefix:r})}};We.Logger=Tt;We.logger=Tt.getInstance()});var ir=H(ce=>{"use strict";Object.defineProperty(ce,"__esModule",{value:!0});ce.sanitizeArgs=ce.redactString=ce.logger=ce.Logger=void 0;var $n=_n();Object.defineProperty(ce,"Logger",{enumerable:!0,get:function(){return $n.Logger}});Object.defineProperty(ce,"logger",{enumerable:!0,get:function(){return $n.logger}});var Sn=or();Object.defineProperty(ce,"redactString",{enumerable:!0,get:function(){return Sn.redactString}});Object.defineProperty(ce,"sanitizeArgs",{enumerable:!0,get:function(){return Sn.sanitizeArgs}})});var Lt=H(($i,In)=>{"use strict";var{Readable:xi,Writable:_i,Duplex:Ps,Transform:Tn}=require("stream"),As=Symbol.for("object-stream.none"),lr=Symbol.for("object-stream.final"),ur=Symbol.for("object-stream.many"),Es=t=>({[lr]:t}),Ts=t=>({[ur]:t}),Is=t=>t&&typeof t=="object"&&lr in t,Fs=t=>t&&typeof t=="object"&&ur in t,Ds=t=>t[lr],Ms=t=>t[ur],Us=async(t,e)=>{for(;;){let r=t.next();if(r&&typeof r.then=="function"&&(r=await r),r.done)break;let n=r.value;n&&typeof n.then=="function"&&(n=await n),L.sanitize(n,e)}},Rs=t=>new Tn({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,n){try{let a=t.call(this,e,r);if(a&&typeof a.then=="function"){a.then(s=>(L.sanitize(s,this),n(null)),s=>n(s));return}if(a&&typeof a.next=="function"){Us(a,this).then(()=>n(null),s=>n(s));return}L.sanitize(a,this),n(null)}catch(a){n(a)}}}),Ls=t=>new Tn({writableObjectMode:!0,readableObjectMode:!0,transform(e,r,n){try{let a=e;for(let s=0;s<t.length;++s){let o=t[s].call(this,a,r);if(o===L.none){n(null);return}if(L.isFinal(o)){a=L.getFinalValue(o);break}a=o}L.sanitize(a,this),n(null)}catch(a){n(a)}}}),An=t=>t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!t._writableState||(typeof t._readableState=="object"?t._readableState.readable:null)!==!1)&&(!t._writableState||t._readableState),En=t=>t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||(typeof t._writableState=="object"?t._writableState.writable:null)!==!1),Os=t=>t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function",L=class t extends Ps{constructor(e,r){if(super(r||{writableObjectMode:!0,readableObjectMode:!0}),!(e instanceof Array)||!e.length)throw Error("Chain's argument should be a non-empty array.");this.streams=e.filter(n=>n).map((n,a,s)=>{if(typeof n=="function"||n instanceof Array)return t.convertToTransform(n);if(Os(n)||!a&&An(n)||a===s.length-1&&En(n))return n;throw Error("Arguments should be functions, arrays or streams.")}).filter(n=>n),this.input=this.streams[0],this.output=this.streams.reduce((n,a)=>n&&n.pipe(a)||a),En(this.input)||(this._write=(n,a,s)=>s(null),this._final=n=>n(null),this.input.on("end",()=>this.end())),An(this.output)?(this.output.on("data",n=>!this.push(n)&&this.output.pause()),this.output.on("end",()=>this.push(null))):(this._read=()=>{},this.resume(),this.output.on("finish",()=>this.push(null))),(!r||!r.skipEvents)&&this.streams.forEach(n=>n.on("error",a=>this.emit("error",a)))}_write(e,r,n){let a=null;try{this.input.write(e,r,s=>n(s||a))}catch(s){a=s}}_final(e){let r=null;try{this.input.end(null,null,n=>e(n||r))}catch(n){r=n}}_read(){this.output.resume()}static make(e,r){return new t(e,r)}static sanitize(e,r){t.isFinal(e)?e=t.getFinalValue(e):t.isMany(e)&&(e=t.getManyValues(e)),e!=null&&e!==t.none&&(e instanceof Array?e.forEach(n=>n!=null&&r.push(n)):r.push(e))}static convertToTransform(e){return typeof e=="function"?Rs(e):e instanceof Array&&e.length?Ls(e):null}};L.none=As;L.final=Es;L.isFinal=Is;L.getFinalValue=Ds;L.many=Ts;L.isMany=Fs;L.getManyValues=Ms;L.chain=L.make;L.make.Constructor=L;In.exports=L});var Dn=H((Si,Fn)=>{"use strict";var{Transform:Ns}=require("stream"),{StringDecoder:Bs}=require("string_decoder"),fr=class extends Ns{constructor(e){super(Object.assign({},e,{writableObjectMode:!1})),this._buffer=""}_transform(e,r,n){typeof e=="string"?this._transform=this._transformString:(this._stringDecoder=new Bs,this._transform=this._transformBuffer),this._transform(e,r,n)}_transformBuffer(e,r,n){this._buffer+=this._stringDecoder.write(e),this._processBuffer(n)}_transformString(e,r,n){this._buffer+=e.toString(),this._processBuffer(n)}_processBuffer(e){this._buffer&&(this.push(this._buffer,"utf8"),this._buffer=""),e(null)}_flushInput(){this._stringDecoder&&(this._buffer+=this._stringDecoder.end())}_flush(e){this._flushInput(),this._processBuffer(e)}};Fn.exports=fr});var dr=H((Ci,Mn)=>{"use strict";var Vs=Dn(),v={value1:/^(?:[\"\{\[\]\-\d]|true\b|false\b|null\b|\s{1,256})/,string:/^(?:[^\x00-\x1f\"\\]{1,256}|\\[bfnrt\"\\\/]|\\u[\da-fA-F]{4}|\")/,key1:/^(?:[\"\}]|\s{1,256})/,colon:/^(?:\:|\s{1,256})/,comma:/^(?:[\,\]\}]|\s{1,256})/,ws:/^\s{1,256}/,numberStart:/^\d/,numberDigit:/^\d{0,256}/,numberFraction:/^[\.eE]/,numberExponent:/^[eE]/,numberExpSign:/^[-+]/},js=16,V=!0;try{new RegExp(".","y"),V=!1}catch{}!V&&Object.keys(v).forEach(t=>{let e=v[t].source.slice(1);e.slice(0,3)==="(?:"&&e.slice(-1)===")"&&(e=e.slice(3,-1)),v[t]=new RegExp(e,"y")});v.numberFracStart=v.numberExpStart=v.numberStart;v.numberFracDigit=v.numberExpDigit=v.numberDigit;var Ws={true:!0,false:!1,null:null},ue={object:"objectStop",array:"arrayStop","":"done"},zs=t=>String.fromCharCode(parseInt(t.slice(2),16)),Hs={b:"\b",f:"\f",n:`
`,r:"\r",t:"	",'"':'"',"\\":"\\","/":"/"},Fe=class t extends Vs{static make(e){return new t(e)}constructor(e){super(Object.assign({},e,{readableObjectMode:!0})),this._packKeys=this._packStrings=this._packNumbers=this._streamKeys=this._streamStrings=this._streamNumbers=!0,e&&("packValues"in e&&(this._packKeys=this._packStrings=this._packNumbers=e.packValues),"packKeys"in e&&(this._packKeys=e.packKeys),"packStrings"in e&&(this._packStrings=e.packStrings),"packNumbers"in e&&(this._packNumbers=e.packNumbers),"streamValues"in e&&(this._streamKeys=this._streamStrings=this._streamNumbers=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys),"streamStrings"in e&&(this._streamStrings=e.streamStrings),"streamNumbers"in e&&(this._streamNumbers=e.streamNumbers),this._jsonStreaming=e.jsonStreaming),!this._packKeys&&(this._streamKeys=!0),!this._packStrings&&(this._streamStrings=!0),!this._packNumbers&&(this._streamNumbers=!0),this._done=!1,this._expect=this._jsonStreaming?"done":"value",this._stack=[],this._parent="",this._open_number=!1,this._accumulator=""}_flush(e){this._done=!0,super._flush(r=>{if(r)return e(r);this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),e(null)})}_processBuffer(e){let r,n,a=0;e:for(;;)switch(this._expect){case"value1":case"value":if(v.value1.lastIndex=a,r=v.value1.exec(this._buffer),!r){if(this._done||a+js<this._buffer.length)return a<this._buffer.length?e(new Error("Parser cannot parse input: expected a value")):e(new Error("Parser has expected a value"));break e}switch(n=r[0],n){case'"':this._streamStrings&&this.push({name:"startString"}),this._expect="string";break;case"{":this.push({name:"startObject"}),this._stack.push(this._parent),this._parent="object",this._expect="key1";break;case"[":this.push({name:"startArray"}),this._stack.push(this._parent),this._parent="array",this._expect="value1";break;case"]":if(this._expect!=="value1")return e(new Error("Parser cannot parse input: unexpected token ']'"));this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),this.push({name:"endArray"}),this._parent=this._stack.pop(),this._expect=ue[this._parent];break;case"-":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"-"})),this._packNumbers&&(this._accumulator="-"),this._expect="numberStart";break;case"0":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:"0"})),this._packNumbers&&(this._accumulator="0"),this._expect="numberFraction";break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":this._open_number=!0,this._streamNumbers&&(this.push({name:"startNumber"}),this.push({name:"numberChunk",value:n})),this._packNumbers&&(this._accumulator=n),this._expect="numberDigit";break;case"true":case"false":case"null":if(this._buffer.length-a===n.length&&!this._done)break e;this.push({name:n+"Value",value:Ws[n]}),this._expect=ue[this._parent];break}V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"keyVal":case"string":if(v.string.lastIndex=a,r=v.string.exec(this._buffer),!r){if(a<this._buffer.length&&(this._done||this._buffer.length-a>=6))return e(new Error("Parser cannot parse input: escaped characters"));if(this._done)return e(new Error("Parser has expected a string value"));break e}if(n=r[0],n==='"')this._expect==="keyVal"?(this._streamKeys&&this.push({name:"endKey"}),this._packKeys&&(this.push({name:"keyValue",value:this._accumulator}),this._accumulator=""),this._expect="colon"):(this._streamStrings&&this.push({name:"endString"}),this._packStrings&&(this.push({name:"stringValue",value:this._accumulator}),this._accumulator=""),this._expect=ue[this._parent]);else if(n.length>1&&n.charAt(0)==="\\"){let s=n.length==2?Hs[n.charAt(1)]:zs(n);(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:s}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=s)}else(this._expect==="keyVal"?this._streamKeys:this._streamStrings)&&this.push({name:"stringChunk",value:n}),(this._expect==="keyVal"?this._packKeys:this._packStrings)&&(this._accumulator+=n);V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"key1":case"key":if(v.key1.lastIndex=a,r=v.key1.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an object key"));break e}if(n=r[0],n==='"')this._streamKeys&&this.push({name:"startKey"}),this._expect="keyVal";else if(n==="}"){if(this._expect!=="key1")return e(new Error("Parser cannot parse input: unexpected token '}'"));this.push({name:"endObject"}),this._parent=this._stack.pop(),this._expect=ue[this._parent]}V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"colon":if(v.colon.lastIndex=a,r=v.colon.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ':'"));break e}n=r[0],n===":"&&(this._expect="value"),V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"arrayStop":case"objectStop":if(v.comma.lastIndex=a,r=v.comma.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected ','"));break e}if(this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),n=r[0],n===",")this._expect=this._expect==="arrayStop"?"value":"key";else if(n==="}"||n==="]"){if(n==="}"?this._expect==="arrayStop":this._expect!=="arrayStop")return e(new Error("Parser cannot parse input: expected '"+(this._expect==="arrayStop"?"]":"}")+"'"));this.push({name:n==="}"?"endObject":"endArray"}),this._parent=this._stack.pop(),this._expect=ue[this._parent]}V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberStart":if(v.numberStart.lastIndex=a,r=v.numberStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a starting digit"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect=n==="0"?"numberFraction":"numberDigit",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberDigit":if(v.numberDigit.lastIndex=a,r=v.numberDigit.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a digit"));break e}if(n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),V?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length){this._expect="numberFraction";break}if(this._done){this._expect=ue[this._parent];break}break e}break;case"numberFraction":if(v.numberFraction.lastIndex=a,r=v.numberFraction.exec(this._buffer),!r){if(a<this._buffer.length||this._done){this._expect=ue[this._parent];break}break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect=n==="."?"numberFracStart":"numberExpSign",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberFracStart":if(v.numberFracStart.lastIndex=a,r=v.numberFracStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected a fractional part of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberFracDigit",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberFracDigit":if(v.numberFracDigit.lastIndex=a,r=v.numberFracDigit.exec(this._buffer),n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),V?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length){this._expect="numberExponent";break}if(this._done){this._expect=ue[this._parent];break}break e}break;case"numberExponent":if(v.numberExponent.lastIndex=a,r=v.numberExponent.exec(this._buffer),!r){if(a<this._buffer.length){this._expect=ue[this._parent];break}if(this._done){this._expect="done";break}break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpSign",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpSign":if(v.numberExpSign.lastIndex=a,r=v.numberExpSign.exec(this._buffer),!r){if(a<this._buffer.length){this._expect="numberExpStart";break}if(this._done)return e(new Error("Parser has expected an exponent value of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpStart",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpStart":if(v.numberExpStart.lastIndex=a,r=v.numberExpStart.exec(this._buffer),!r){if(a<this._buffer.length||this._done)return e(new Error("Parser cannot parse input: expected an exponent part of a number"));break e}n=r[0],this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),this._expect="numberExpDigit",V?this._buffer=this._buffer.slice(n.length):a+=n.length;break;case"numberExpDigit":if(v.numberExpDigit.lastIndex=a,r=v.numberExpDigit.exec(this._buffer),n=r[0],n)this._streamNumbers&&this.push({name:"numberChunk",value:n}),this._packNumbers&&(this._accumulator+=n),V?this._buffer=this._buffer.slice(n.length):a+=n.length;else{if(a<this._buffer.length||this._done){this._expect=ue[this._parent];break}break e}break;case"done":if(v.ws.lastIndex=a,r=v.ws.exec(this._buffer),!r){if(a<this._buffer.length){if(this._jsonStreaming){this._expect="value";break}return e(new Error("Parser cannot parse input: unexpected characters"))}break e}n=r[0],this._open_number&&(this._streamNumbers&&this.push({name:"endNumber"}),this._open_number=!1,this._packNumbers&&(this.push({name:"numberValue",value:this._accumulator}),this._accumulator="")),V?this._buffer=this._buffer.slice(n.length):a+=n.length;break}!V&&(this._buffer=this._buffer.slice(a)),e(null)}};Fe.parser=Fe.make;Fe.make.Constructor=Fe;Mn.exports=Fe});var Rn=H((vi,Un)=>{"use strict";var Ks=t=>t.on("data",e=>t.emit(e.name,e.value));Un.exports=Ks});var pr=H((Pi,Ln)=>{"use strict";var hr=dr(),qs=Rn(),mr=t=>qs(new hr(t));mr.Parser=hr;mr.parser=hr.parser;Ln.exports=mr});var yr=H((Ai,On)=>{"use strict";var{Transform:Gs}=require("stream"),fe=class t extends Gs{static stringFilter(e,r){return n=>{let a=n.join(r);return a.length===e.length&&a===e||a.length>e.length&&a.substr(0,e.length)===e&&a.substr(e.length,r.length)===r}}static regExpFilter(e,r){return n=>e.test(n.join(r))}static arrayReplacement(e){return()=>e}constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),this._transform=this._check,this._stack=[];let r=e&&e.filter,n=e&&e.pathSeparator||".";typeof r=="string"?this._filter=t.stringFilter(r,n):typeof r=="function"?this._filter=r:r instanceof RegExp&&(this._filter=t.regExpFilter(r,n));let a=e&&e.replacement;typeof a=="function"?this._replacement=a:this._replacement=t.arrayReplacement(a||t.defaultReplacement),this._allowEmptyReplacement=e&&e.allowEmptyReplacement,this._streamKeys=!0,e&&("streamValues"in e&&(this._streamKeys=e.streamValues),"streamKeys"in e&&(this._streamKeys=e.streamKeys)),this._once=e&&e.once,this._previousToken=""}_check(e,r,n){switch(e.name){case"startObject":case"startArray":case"startString":case"startNumber":case"nullValue":case"trueValue":case"falseValue":typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"keyValue":this._stack[this._stack.length-1]=e.value;break;case"numberValue":this._previousToken!=="endNumber"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break;case"stringValue":this._previousToken!=="endString"&&typeof this._stack[this._stack.length-1]=="number"&&++this._stack[this._stack.length-1];break}if(this._previousToken=e.name,this._checkChunk(e))return n(null);switch(e.name){case"startObject":this._stack.push(null);break;case"startArray":this._stack.push(-1);break;case"endObject":case"endArray":this._stack.pop();break}n(null)}_passObject(e,r,n){switch(this.push(e),e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._skip:this._check),n(null)}_pass(e,r,n){this.push(e),n(null)}_skipObject(e,r,n){switch(e.name){case"startObject":case"startArray":++this._depth;break;case"endObject":case"endArray":--this._depth;break}this._depth||(this._transform=this._once?this._pass:this._check),n(null)}_skip(e,r,n){n(null)}};fe.defaultReplacement=[{name:"nullValue",value:null}];var gr=(t,e)=>function(r,n,a){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._skip:this._check,s===r.name)this.push(r);else return this._transform(r,n,a)}else this.push(r),r.name===t&&(this._expected=e);a(null)};fe.prototype._passNumber=gr("endNumber","numberValue");fe.prototype._passString=gr("endString","stringValue");fe.prototype._passKey=gr("endKey","keyValue");var br=(t,e)=>function(r,n,a){if(this._expected){let s=this._expected;if(this._expected="",this._transform=this._once?this._pass:this._check,s!==r.name)return this._transform(r,n,a)}else r.name===t&&(this._expected=e);a(null)};fe.prototype._skipNumber=br("endNumber","numberValue");fe.prototype._skipString=br("endString","stringValue");fe.prototype._skipKey=br("endKey","keyValue");On.exports=fe});var dt=H((Ei,Nn)=>{"use strict";var{chain:Js}=Lt(),Zs=dr(),Ys=(t,e)=>Js([new Zs(e),t(e)],Object.assign({},e,{writableObjectMode:!1,readableObjectMode:!0}));Nn.exports=Ys});var Vn=H((Ti,Bn)=>{"use strict";var Xs=yr(),Qs=dt(),De=class t extends Xs{static make(e){return new t(e)}static withParser(e){return Qs(t.make,e)}constructor(e){super(e),this._once=!1,this._lastStack=[]}_flush(e){this._syncStack(),e(null)}_checkChunk(e){switch(e.name){case"startObject":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(null));break;case"startArray":this._filter(this._stack,e)&&(this._syncStack(),this.push(e),this._lastStack.push(-1));break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":this._filter(this._stack,e)&&(this._syncStack(),this.push(e));break;case"startString":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passString):this._transform=this._skipString;break;case"startNumber":this._filter(this._stack,e)?(this._syncStack(),this.push(e),this._transform=this._passNumber):this._transform=this._skipNumber;break}return!1}_syncStack(){let e=this._stack,r=this._lastStack,n=e.length,a=r.length,s=0;for(let o=Math.min(n,a);s<o&&e[s]===r[s];++s);for(let o=a-1;o>s;--o)this.push({name:typeof r[o]=="number"?"endArray":"endObject"});if(s<a)if(s<n){if(typeof e[s]=="string"){let o=e[s];this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:o}),this.push({name:"endKey"})),this.push({name:"keyValue",value:o})}++s}else this.push({name:typeof r[s]=="number"?"endArray":"endObject"});for(let o=s;o<n;++o){let i=e[o];typeof i=="number"?i>=0&&this.push({name:"startArray"}):typeof i=="string"&&(this.push({name:"startObject"}),this._streamKeys&&(this.push({name:"startKey"}),this.push({name:"stringChunk",value:i}),this.push({name:"endKey"})),this.push({name:"keyValue",value:i}))}this._lastStack=Array.prototype.concat.call(e)}};De.filter=De.make;De.make.Constructor=De;Bn.exports=De});var zn=H((Ii,Wn)=>{"use strict";var eo=require("events"),jn=t=>function(){this.done?this.done=!1:this.stack.push(this.current,this.key),this.current=new t,this.key=null},be=class t extends eo{static connectTo(e,r){return new t(r).connectTo(e)}constructor(e){super(),this.stack=[],this.current=this.key=null,this.done=!0,e&&(this.reviver=typeof e.reviver=="function"&&e.reviver,this.reviver&&(this.stringValue=this._saveValue=this._saveValueWithReviver),e.numberAsString&&(this.numberValue=this.stringValue))}connectTo(e){return e.on("data",r=>{this[r.name]&&(this[r.name](r.value),this.done&&this.emit("done",this))}),this}get depth(){return(this.stack.length>>1)+(this.done?0:1)}get path(){let e=[];for(let r=0;r<this.stack.length;r+=2){let n=this.stack[r+1];e.push(n===null?this.stack[r].length:n)}return e}dropToLevel(e){if(e<this.depth)if(e){let r=e-1<<1;this.current=this.stack[r],this.key=this.stack[r+1],this.stack.splice(r)}else this.stack=[],this.current=this.key=null,this.done=!0;return this}consume(e){return this[e.name]&&this[e.name](e.value),this}keyValue(e){this.key=e}numberValue(e){this._saveValue(parseFloat(e))}nullValue(){this._saveValue(null)}trueValue(){this._saveValue(!0)}falseValue(){this._saveValue(!1)}endObject(){if(this.stack.length){let e=this.current;this.key=this.stack.pop(),this.current=this.stack.pop(),this._saveValue(e)}else this.done=!0}_saveValue(e){this.done?this.current=e:this.current instanceof Array?this.current.push(e):(this.current[this.key]=e,this.key=null)}_saveValueWithReviver(e){this.done?this.current=this.reviver("",e):this.current instanceof Array?(e=this.reviver(""+this.current.length,e),this.current.push(e),e===void 0&&delete this.current[this.current.length-1]):(e=this.reviver(this.key,e),e!==void 0&&(this.current[this.key]=e),this.key=null)}};be.prototype.stringValue=be.prototype._saveValue;be.prototype.startObject=jn(Object);be.prototype.startArray=jn(Array);be.prototype.endArray=be.prototype.endObject;Wn.exports=be});var xr=H((Fi,Hn)=>{"use strict";var{Transform:to}=require("stream"),ro=zn(),wr=class{constructor(e){this.depth=e}startObject(){++this.depth}endObject(){--this.depth}startArray(){++this.depth}endArray(){--this.depth}},kr=class extends to{constructor(e){super(Object.assign({},e,{writableObjectMode:!0,readableObjectMode:!0})),e&&(this.objectFilter=e.objectFilter,this.includeUndecided=e.includeUndecided),typeof this.objectFilter!="function"&&(this._filter=this._transform),this._transform=this._wait||this._filter,this._assembler=new ro(e)}_transform(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&this._push()),n(null)}_filter(e,r,n){if(this._assembler[e.name]){this._assembler[e.name](e.value);let a=this.objectFilter(this._assembler);if(a)return this._assembler.depth===this._level&&(this._push(),this._transform=this._filter),this._transform=this._accept,n(null);if(a===!1)return this._saved_assembler=this._assembler,this._assembler=new wr(this._saved_assembler.depth),this._saved_assembler.dropToLevel(this._level),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter),this._transform=this._reject,n(null);this._assembler.depth===this._level&&this._push(!this.includeUndecided)}n(null)}_accept(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._push(),this._transform=this._filter)),n(null)}_reject(e,r,n){this._assembler[e.name]&&(this._assembler[e.name](e.value),this._assembler.depth===this._level&&(this._assembler=this._saved_assembler,this._transform=this._filter)),n(null)}};Hn.exports=kr});var qn=H((Di,Kn)=>{"use strict";var no=xr(),ao=dt(),Me=class t extends no{static make(e){return new t(e)}static withParser(e){return ao(t.make,e)}constructor(e){super(e),this._level=1,this._counter=0}_wait(e,r,n){return e.name!=="startArray"?n(new Error("Top-level object should be an array.")):(this._transform=this._filter,this._transform(e,r,n))}_push(e){this._assembler.current.length&&(e?(++this._counter,this._assembler.current.pop()):this.push({key:this._counter++,value:this._assembler.current.pop()}))}};Me.streamArray=Me.make;Me.make.Constructor=Me;Kn.exports=Me});var ma=H((sc,ha)=>{"use strict";var bo=yr(),yo=dt(),Le=class t extends bo{static make(e){return new t(e)}static withParser(e){return yo(t.make,e)}_checkChunk(e){switch(e.name){case"startObject":case"startArray":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passObject,this._depth=1,!0;break;case"startString":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passString,!0;break;case"startNumber":if(this._filter(this._stack,e))return this.push(e),this._transform=this._passNumber,!0;break;case"nullValue":case"trueValue":case"falseValue":case"stringValue":case"numberValue":if(this._filter(this._stack,e))return this.push(e),this._transform=this._once?this._skip:this._check,!0;break}return!1}};Le.pick=Le.make;Le.make.Constructor=Le;ha.exports=Le});var ga=H((oc,pa)=>{"use strict";var wo=xr(),ko=dt(),Oe=class t extends wo{static make(e){return new t(e)}static withParser(e){return ko(t.make,e)}constructor(e){super(e),this._level=1,this._lastKey=null}_wait(e,r,n){return e.name!=="startObject"?n(new Error("Top-level object should be an object.")):(this._transform=this._filter,this._transform(e,r,n))}_push(e){this._lastKey===null?this._lastKey=this._assembler.key:(!e&&this.push({key:this._lastKey,value:this._assembler.current[this._lastKey]}),this._assembler.current={},this._lastKey=null)}};Oe.streamObject=Oe.make;Oe.make.Constructor=Oe;pa.exports=Oe});var ui={};ns(ui,{default:()=>Ja});module.exports=as(ui);var Ne=require("react"),U=require("@raycast/api");var P=R(require("react")),E=require("@raycast/api");var tn=Object.prototype.hasOwnProperty;function vt(t,e){var r,n;if(t===e)return!0;if(t&&e&&(r=t.constructor)===e.constructor){if(r===Date)return t.getTime()===e.getTime();if(r===RegExp)return t.toString()===e.toString();if(r===Array){if((n=t.length)===e.length)for(;n--&&vt(t[n],e[n]););return n===-1}if(!r||typeof t=="object"){n=0;for(r in t)if(tn.call(t,r)&&++n&&!tn.call(e,r)||!(r in e)||!vt(t[r],e[r]))return!1;return Object.keys(e).length===n}}return t!==t&&e!==e}var Ee=R(require("node:fs")),At=R(require("node:path")),fn=R(require("node:crypto")),dn=R(require("node:child_process")),hn=require("node:buffer"),Ve=R(require("node:stream")),mn=require("node:util");var pn=require("react/jsx-runtime");var Yt=globalThis;function ss(t){let e=(0,P.useRef)(t),r=(0,P.useRef)(0);return vt(t,e.current)||(e.current=t,r.current+=1),(0,P.useMemo)(()=>e.current,[r.current])}function te(t){let e=(0,P.useRef)(t);return e.current=t,e}function os(t,e){let r=t instanceof Error?t.message:String(t);return(0,E.showToast)({style:E.Toast.Style.Failure,title:e?.title??"Something went wrong",message:e?.message??r,primaryAction:e?.primaryAction??rn(t),secondaryAction:e?.primaryAction?rn(t):void 0})}var rn=t=>{let e=!0,r="[Extension Name]...",n="";try{let o=JSON.parse((0,Ee.readFileSync)((0,At.join)(E.environment.assetsPath,"..","package.json"),"utf8"));r=`[${o.title}]...`,n=`https://raycast.com/${o.owner||o.author}/${o.name}`,(!o.owner||o.access==="public")&&(e=!1)}catch{}let a=E.environment.isDevelopment||e,s=t instanceof Error?t?.stack||t?.message||"":String(t);return{title:a?"Copy Logs":"Report Error",onAction(o){o.hide(),a?E.Clipboard.copy(s):(0,E.open)(`https://github.com/raycast/extensions/issues/new?&labels=extension%2Cbug&template=extension_bug_report.yml&title=${encodeURIComponent(r)}&extension-url=${encodeURI(n)}&description=${encodeURIComponent(`#### Error:
\`\`\`
${s}
\`\`\`
`)}`)}}};function is(t,e,r){let n=(0,P.useRef)(0),[a,s]=(0,P.useState)({isLoading:!0}),o=te(t),i=te(r?.abortable),c=te(e||[]),u=te(r?.onError),l=te(r?.onData),f=te(r?.onWillExecute),g=te(r?.failureToastOptions),y=te(a.data),_=(0,P.useRef)(null),m=(0,P.useRef)({page:0}),w=(0,P.useRef)(!1),b=(0,P.useRef)(!0),$=(0,P.useRef)(50),k=(0,P.useCallback)(()=>(i.current&&(i.current.current?.abort(),i.current.current=new AbortController),++n.current),[i]),x=(0,P.useCallback)((...ee)=>{let B=k();f.current?.(ee),s(I=>({...I,isLoading:!0}));let se=cs(o.current)(...ee);function xe(I){return I.name=="AbortError"||B===n.current&&(u.current?u.current(I):E.environment.launchType!==E.LaunchType.Background&&os(I,{title:"Failed to fetch latest data",primaryAction:{title:"Retry",onAction(Ae){Ae.hide(),_.current?.(...c.current||[])}},...g.current}),s({error:I,isLoading:!1})),I}return typeof se=="function"?(w.current=!0,se(m.current).then(({data:I,hasMore:Ae,cursor:Za})=>(B===n.current&&(m.current&&(m.current.cursor=Za,m.current.lastItem=I?.[I.length-1]),l.current&&l.current(I,m.current),Ae&&($.current=I.length),b.current=Ae,s(Ya=>m.current.page===0?{data:I,isLoading:!1}:{data:(Ya.data||[])?.concat(I),isLoading:!1})),I),I=>(b.current=!1,xe(I)))):(w.current=!1,se.then(I=>(B===n.current&&(l.current&&l.current(I),s({data:I,isLoading:!1})),I),xe))},[l,u,c,o,s,_,f,m,g,k]);_.current=x;let S=(0,P.useCallback)(()=>{m.current={page:0};let ee=c.current||[];return x(...ee)},[x,c]),p=(0,P.useCallback)(async(ee,B)=>{let se;try{if(B?.optimisticUpdate){k(),typeof B?.rollbackOnError!="function"&&B?.rollbackOnError!==!1&&(se=structuredClone(y.current?.value));let xe=B.optimisticUpdate;s(I=>({...I,data:xe(I.data)}))}return await ee}catch(xe){if(typeof B?.rollbackOnError=="function"){let I=B.rollbackOnError;s(Ae=>({...Ae,data:I(Ae.data)}))}else B?.optimisticUpdate&&B?.rollbackOnError!==!1&&s(I=>({...I,data:se}));throw xe}finally{B?.shouldRevalidateAfter!==!1&&(E.environment.launchType===E.LaunchType.Background||E.environment.commandMode==="menu-bar"?await S():S())}},[S,y,s,k]),C=(0,P.useCallback)(()=>{m.current.page+=1;let ee=c.current||[];x(...ee)},[m,c,x]);(0,P.useEffect)(()=>{m.current={page:0},r?.execute!==!1?x(...e||[]):k()},[ss([e,r?.execute,x]),i,m]),(0,P.useEffect)(()=>()=>{k()},[k]);let M=r?.execute!==!1?a.isLoading:!1,A={...a,isLoading:M},it=w.current?{pageSize:$.current,hasMore:b.current,onLoadMore:C}:void 0;return{...A,revalidate:S,mutate:p,pagination:it}}function cs(t){return t===Promise.all||t===Promise.race||t===Promise.resolve||t===Promise.reject?t.bind(Promise):t}function nn(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!==null}function ls(t){return t instanceof URLSearchParams?t.toString():t}function gn(t,e=[]){function r(n){return"update"in t?t.update(n,"utf8"):t.write(n)}return{dispatch:function(n){n=ls(n),n===null?this._null():this["_"+typeof n](n)},_object:function(n){let a=/\[object (.*)\]/i,s=Object.prototype.toString.call(n),o=a.exec(s)?.[1]??"unknown:["+s+"]";o=o.toLowerCase();let i=null;if((i=e.indexOf(n))>=0){this.dispatch("[CIRCULAR:"+i+"]");return}else e.push(n);if(Buffer.isBuffer(n))return r("buffer:"),r(n.toString("utf8"));if(o!=="object"&&o!=="function"&&o!=="asyncfunction")if(this["_"+o])this["_"+o](n);else throw new Error('Unknown object type "'+o+'"');else{let c=Object.keys(n);c=c.sort(),nn(n)||c.splice(0,0,"prototype","__proto__","constructor"),r("object:"+c.length+":");let u=this;return c.forEach(function(l){u.dispatch(l),r(":"),u.dispatch(n[l]),r(",")})}},_array:function(n,a){a=typeof a<"u"?a:!1;let s=this;if(r("array:"+n.length+":"),!a||n.length<=1){n.forEach(function(c){s.dispatch(c)});return}let o=[],i=n.map(function(c){let u=us(),l=e.slice();return gn(u,l).dispatch(c),o=o.concat(l.slice(e.length)),u.read().toString()});e=e.concat(o),i.sort(),this._array(i,!1)},_date:function(n){r("date:"+n.toJSON())},_symbol:function(n){r("symbol:"+n.toString())},_error:function(n){r("error:"+n.toString())},_boolean:function(n){r("bool:"+n.toString())},_string:function(n){r("string:"+n.length+":"),r(n.toString())},_function:function(n){r("fn:"),nn(n)?this.dispatch("[native]"):this.dispatch(n.toString()),this.dispatch("function-name:"+String(n.name)),this._object(n)},_number:function(n){r("number:"+n.toString())},_xml:function(n){r("xml:"+n.toString())},_null:function(){r("Null")},_undefined:function(){r("Undefined")},_regexp:function(n){r("regex:"+n.toString())},_uint8array:function(n){r("uint8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint8clampedarray:function(n){r("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(n))},_int8array:function(n){r("int8array:"),this.dispatch(Array.prototype.slice.call(n))},_uint16array:function(n){r("uint16array:"),this.dispatch(Array.prototype.slice.call(n))},_int16array:function(n){r("int16array:"),this.dispatch(Array.prototype.slice.call(n))},_uint32array:function(n){r("uint32array:"),this.dispatch(Array.prototype.slice.call(n))},_int32array:function(n){r("int32array:"),this.dispatch(Array.prototype.slice.call(n))},_float32array:function(n){r("float32array:"),this.dispatch(Array.prototype.slice.call(n))},_float64array:function(n){r("float64array:"),this.dispatch(Array.prototype.slice.call(n))},_arraybuffer:function(n){r("arraybuffer:"),this.dispatch(new Uint8Array(n))},_url:function(n){r("url:"+n.toString())},_map:function(n){r("map:");let a=Array.from(n);this._array(a,!0)},_set:function(n){r("set:");let a=Array.from(n);this._array(a,!0)},_file:function(n){r("file:"),this.dispatch([n.name,n.size,n.type,n.lastModified])},_blob:function(){throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){r("domwindow")},_bigint:function(n){r("bigint:"+n.toString())},_process:function(){r("process")},_timer:function(){r("timer")},_pipe:function(){r("pipe")},_tcp:function(){r("tcp")},_udp:function(){r("udp")},_tty:function(){r("tty")},_statwatcher:function(){r("statwatcher")},_securecontext:function(){r("securecontext")},_connection:function(){r("connection")},_zlib:function(){r("zlib")},_context:function(){r("context")},_nodescript:function(){r("nodescript")},_httpparser:function(){r("httpparser")},_dataview:function(){r("dataview")},_signal:function(){r("signal")},_fsevent:function(){r("fsevent")},_tlswrap:function(){r("tlswrap")}}}function us(){return{buf:"",write:function(t){this.buf+=t},end:function(t){this.buf+=t},read:function(){return this.buf}}}function fs(t,e){let r=this[t];return r instanceof Date?`__raycast_cached_date__${r.toISOString()}`:Buffer.isBuffer(r)?`__raycast_cached_buffer__${r.toString("base64")}`:e}function ds(t,e){return typeof e=="string"&&e.startsWith("__raycast_cached_date__")?new Date(e.replace("__raycast_cached_date__","")):typeof e=="string"&&e.startsWith("__raycast_cached_buffer__")?Buffer.from(e.replace("__raycast_cached_buffer__",""),"base64"):e}function an(t){let e=fn.default.createHash("sha1");return gn(e).dispatch(t),e.digest("hex")}var hs=Symbol("cache without namespace"),sn=new Map;function ar(t,e,r){let n=r?.cacheNamespace||hs,a=sn.get(n)||sn.set(n,new E.Cache({namespace:r?.cacheNamespace})).get(n);if(!a)throw new Error("Missing cache");let s=te(t),o=te(e),i=(0,P.useSyncExternalStore)(a.subscribe,()=>{try{return a.get(s.current)}catch(f){console.error("Could not get Cache data:",f);return}}),c=(0,P.useMemo)(()=>{if(typeof i<"u"){if(i==="undefined")return;try{return JSON.parse(i,ds)}catch(f){return console.warn("The cached data is corrupted",f),o.current}}else return o.current},[i,o]),u=te(c),l=(0,P.useCallback)(f=>{let g=typeof f=="function"?f(u.current):f;if(typeof g>"u")a.set(s.current,"undefined");else{let y=JSON.stringify(g,fs);a.set(s.current,y)}return g},[a,s,u]);return[c,l]}var Be=Symbol();function je(t,e,r){let{initialData:n,keepPreviousData:a,internal_cacheKeySuffix:s,...o}=r||{},i=(0,P.useRef)(null),[c,u]=ar(an(e||[])+s,Be,{cacheNamespace:an(t)}),l=(0,P.useRef)(c!==Be?c:n),f=(0,P.useRef)(void 0),{mutate:g,revalidate:y,..._}=is(t,e||[],{...o,onData(k,x){f.current=x,o.onData&&o.onData(k,x),!(x&&x.page>0)&&(i.current="promise",l.current=k,u(k))}}),m,w=_.pagination;f.current&&f.current.page>0&&_.data?m=_.data:i.current==="promise"?m=l.current:a&&c!==Be?(m=c,w&&(w.hasMore=!0,w.pageSize=c.length)):a&&c===Be?m=l.current:c!==Be?(m=c,w&&(w.hasMore=!0,w.pageSize=c.length)):m=n;let b=te(m),$=(0,P.useCallback)(async(k,x)=>{let S;try{if(x?.optimisticUpdate){typeof x?.rollbackOnError!="function"&&x?.rollbackOnError!==!1&&(S=structuredClone(b.current));let p=x.optimisticUpdate(b.current);i.current="cache",l.current=p,u(p)}return await g(k,{shouldRevalidateAfter:x?.shouldRevalidateAfter})}catch(p){if(typeof x?.rollbackOnError=="function"){let C=x.rollbackOnError(b.current);i.current="cache",l.current=C,u(C)}else x?.optimisticUpdate&&x?.rollbackOnError!==!1&&(i.current="cache",l.current=S,u(S));throw p}},[u,g,b,l,i]);return(0,P.useEffect)(()=>{c!==Be&&(i.current="cache",l.current=c)},[c]),{data:m,isLoading:_.isLoading,error:_.error,mutate:f.current&&f.current.page>0?g:$,pagination:w,revalidate:y}}var Pt=t=>!!t&&typeof t=="object"&&typeof t.removeListener=="function"&&typeof t.emit=="function"&&typeof t.reallyExit=="function"&&typeof t.listeners=="function"&&typeof t.kill=="function"&&typeof t.pid=="number"&&typeof t.on=="function",Xt=Symbol.for("signal-exit emitter"),er=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),Yt[Xt])return Yt[Xt];Object.defineProperty(Yt,Xt,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(e,r){this.listeners[e].push(r)}removeListener(e,r){let n=this.listeners[e],a=n.indexOf(r);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(e,r,n){if(this.emitted[e])return!1;this.emitted[e]=!0;let a=!1;for(let s of this.listeners[e])a=s(r,n)===!0||a;return e==="exit"&&(a=this.emit("afterExit",r,n)||a),a}},tr=class{onExit(){return()=>{}}load(){}unload(){}},rr=class{#i;#t;#e;#s;#o;#a;#n;#r;constructor(e){this.#i=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new er,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=e,this.#a={};for(let r of this.#r)this.#a[r]=()=>{let n=this.#e.listeners(r),{count:a}=this.#t,s=e;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let o=this.#t.emit("exit",null,r),i=r==="SIGHUP"?this.#i:r;o||e.kill(e.pid,i)}};this.#o=e.reallyExit,this.#s=e.emit}onExit(e,r){if(!Pt(this.#e))return()=>{};this.#n===!1&&this.load();let n=r?.alwaysLast?"afterExit":"exit";return this.#t.on(n,e),()=>{this.#t.removeListener(n,e),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let e of this.#r)try{let r=this.#a[e];r&&this.#e.on(e,r)}catch{}this.#e.emit=(e,...r)=>this.#l(e,...r),this.#e.reallyExit=e=>this.#c(e)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(e=>{let r=this.#a[e];if(!r)throw new Error("Listener not defined for signal: "+e);try{this.#e.removeListener(e,r)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#o,this.#t.count-=1)}#c(e){return Pt(this.#e)?(this.#e.exitCode=e||0,this.#t.emit("exit",this.#e.exitCode,null),this.#o.call(this.#e,this.#e.exitCode)):0}#l(e,...r){let n=this.#s;if(e==="exit"&&Pt(this.#e)){typeof r[0]=="number"&&(this.#e.exitCode=r[0]);let a=n.call(this.#e,e,...r);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,e,...r)}},Qt=null,ms=(t,e)=>(Qt||(Qt=Pt(process)?new rr(process):new tr),Qt.onExit(t,e));function ps(t,{timeout:e}={}){let r=new Promise((i,c)=>{t.on("exit",(u,l)=>{i({exitCode:u,signal:l,timedOut:!1})}),t.on("error",u=>{c(u)}),t.stdin&&t.stdin.on("error",u=>{c(u)})}),n=ms(()=>{t.kill()});if(e===0||e===void 0)return r.finally(()=>n());let a,s=new Promise((i,c)=>{a=setTimeout(()=>{t.kill("SIGTERM"),c(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},e)}),o=r.finally(()=>{clearTimeout(a)});return Promise.race([s,o]).finally(()=>n())}var nr=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function gs(t){let{encoding:e}=t,r=e==="buffer",n=new Ve.default.PassThrough({objectMode:!1});e&&e!=="buffer"&&n.setEncoding(e);let a=0,s=[];return n.on("data",o=>{s.push(o),a+=o.length}),n.getBufferedValue=()=>r?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function on(t,e){let r=gs(e);return await new Promise((n,a)=>{let s=o=>{o&&r.getBufferedLength()<=hn.constants.MAX_LENGTH&&(o.bufferedData=r.getBufferedValue()),a(o)};(async()=>{try{await(0,mn.promisify)(Ve.default.pipeline)(t,r),n()}catch(o){s(o)}})(),r.on("data",()=>{r.getBufferedLength()>8e7&&s(new nr)})}),r.getBufferedValue()}async function cn(t,e){t.destroy();try{return await e}catch(r){return r.bufferedData}}async function bs({stdout:t,stderr:e},{encoding:r},n){let a=on(t,{encoding:r}),s=on(e,{encoding:r});try{return await Promise.all([n,a,s])}catch(o){return Promise.all([{error:o,exitCode:null,signal:o.signal,timedOut:o.timedOut||!1},cn(t,a),cn(e,s)])}}function ys(t){let e=typeof t=="string"?`
`:10,r=typeof t=="string"?"\r":13;return t[t.length-1]===e&&(t=t.slice(0,-1)),t[t.length-1]===r&&(t=t.slice(0,-1)),t}function ln(t,e){return t.stripFinalNewline?ys(e):e}function ws({timedOut:t,timeout:e,signal:r,exitCode:n}){return t?`timed out after ${e} milliseconds`:r!=null?`was killed with ${r}`:n!=null?`failed with exit code ${n}`:"failed"}function ks({stdout:t,stderr:e,error:r,signal:n,exitCode:a,command:s,timedOut:o,options:i,parentError:c}){let l=`Command ${ws({timedOut:o,timeout:i?.timeout,signal:n,exitCode:a})}: ${s}`,f=r?`${l}
${r.message}`:l,g=[f,e,t].filter(Boolean).join(`
`);return r?r.originalMessage=r.message:r=c,r.message=g,r.shortMessage=f,r.command=s,r.exitCode=a,r.signal=n,r.stdout=t,r.stderr=e,"bufferedData"in r&&delete r.bufferedData,r}function xs({stdout:t,stderr:e,error:r,exitCode:n,signal:a,timedOut:s,command:o,options:i,parentError:c}){if(r||n!==0||a!==null)throw ks({error:r,exitCode:n,signal:a,stdout:t,stderr:e,command:o,timedOut:s,options:i,parentError:c});return t}function un(t,e,r,n){let a=(n-90)*Math.PI/180;return{x:t+r*Math.cos(a),y:e+r*Math.sin(a)}}function _s(t,e,r,n,a){let s=un(t,e,r,a),o=un(t,e,r,n),i=a-n<=180?"0":"1";return["M",s.x,s.y,"A",r,r,0,i,0,o.x,o.y].join(" ")}function ct(t,e=E.Color.Red,r){let n=r?.background||(E.environment.appearance==="light"?"black":"white"),a=r?.backgroundOpacity||.1,s=10,i=50-5-s/2,c=`<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px">
      <circle cx="50" cy="50" r="${i}" stroke-width="${s}" stroke="${t<1?n:e}" opacity="${t<1?a:"1"}" fill="none" />
      ${t>0&&t<1?`<path d="${_s(50,50,i,0,t*360)}" stroke="${e}" stroke-width="${s}" fill="none" />`:""}
    </svg>
  `.replaceAll(`
`,"");return`data:image/svg+xml,${encodeURIComponent(c)}`}async function bn(t,e,r){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...o}=Array.isArray(e)?r||{}:e||{},i=n!==!1?[]:["-ss"];a==="JavaScript"&&i.push("-l","JavaScript"),Array.isArray(e)&&i.push("-",...e);let c=dn.default.spawn("osascript",i,{...o,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),u=ps(c,{timeout:s??1e4});c.stdin.end(t);let[{error:l,exitCode:f,signal:g,timedOut:y},_,m]=await bs(c,{encoding:"utf8"},u),w=ln({stripFinalNewline:!0},_),b=ln({stripFinalNewline:!0},m);return xs({stdout:w,stderr:b,error:l,exitCode:f,signal:g,timedOut:y,command:"osascript",options:r,parentError:new Error})}var Ea=require("react"),Xe=require("@raycast/api");var yn=require("@raycast/api"),T=(0,yn.getPreferenceValues)();var Cn=R(ir()),Te=new Cn.Logger({prefix:"[Brew]"}),D=Te.child("[Commands]"),q=Te.child("[Cache]"),Q=Te.child("[Actions]"),N=Te.child("[Fetch]"),oe=Te.child("[Search]"),re=Te.child("[UI]");var G=class extends Error{constructor(e,r){super(e),this.name="BrewError",this.brewCause=r?.cause}},_e=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="NetworkError",this.statusCode=r?.statusCode,this.url=r?.url}},lt=class extends G{constructor(e,r){super(e,r),this.name="ParseError"}},ze=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewCommandError",this.command=r?.command,this.exitCode=r?.exitCode,this.stderr=r?.stderr}},It=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewNotFoundError",this.path=r?.path}};var le=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="BrewLockError",this.command=r?.command}},ut=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="DownloadTimeoutError",this.packageName=r?.packageName,this.phase=r?.phase,this.timeoutMs=r?.timeoutMs,this.elapsedMs=r?.elapsedMs}},$e=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="StaleProcessError",this.packageName=r?.packageName,this.lastPhase=r?.lastPhase,this.staleDurationMs=r?.staleDurationMs}},Ft=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageNotFoundError",this.packageName=r?.packageName,this.packageType=r?.packageType}},Dt=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageDisabledError",this.packageName=r?.packageName,this.packageType=r?.packageType,this.disabledDate=r?.disabledDate,this.reason=r?.reason}},Mt=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="PackageConflictError",this.packageName=r?.packageName,this.conflictsWith=r?.conflictsWith}},Ut=class extends G{constructor(e,r){super(e,{cause:r?.cause}),this.name="UnsupportedMacOSError",this.packageName=r?.packageName,this.requiredVersion=r?.requiredVersion,this.currentVersion=r?.currentVersion}};function Rt(t){return t instanceof _e}function ie(t){return t instanceof le}function vn(t){return t instanceof ut}function Pn(t){return t instanceof $e}function Ie(t){return Rt(t)||ie(t)||vn(t)||Pn(t)}var Cs=[/lockf:.*already locked/i,/another active Homebrew/i,/another brew process/i,/another.*brew.*update.*process/i,/Homebrew is already running/i,/Error: Another active Homebrew/i,/Error: Another.*brew.*process/i,/waiting for lock/i,/lock file/i,/has already locked/i,/brew upgrade.*process has already/i],vs=/Error: (Cask|Formula) '([^']+)' has been disabled(?: because (.+?))?(?:! It was disabled on (\d{4}-\d{2}-\d{2}))?/i;function ft(t){return Cs.some(e=>e.test(t))}function cr(t){let e=t.match(vs);return e?{packageType:e[1].toLowerCase(),packageName:e[2],reason:e[3]?.trim(),disabledDate:e[4]}:null}function ne(t){return t instanceof Error?t:new Error(String(t))}function ge(t){if(t instanceof le)return"Another brew process is already running. Please wait for it to finish and try again.";if(t instanceof ut){let e=t.packageName?` for "${t.packageName}"`:"",r=t.phase?` during ${t.phase}`:"";return`Download timed out${e}${r}. Please try again.`}if(t instanceof $e){let e=t.packageName?` for "${t.packageName}"`:"",r=t.lastPhase?` (stuck at ${t.lastPhase})`:"";return`Process appears stuck${e}${r}. The operation was cancelled.`}if(t instanceof Dt){let e=t.packageType??"package",n=`${e.charAt(0).toUpperCase()+e.slice(1)} "${t.packageName}" has been discontinued`;return t.reason&&(n+=`: ${t.reason}`),t.disabledDate&&(n+=` (disabled on ${t.disabledDate})`),n}if(t instanceof Mt){let e=t.conflictsWith?.join(", ")??"another package";return`"${t.packageName}" conflicts with ${e}. Please uninstall the conflicting package first.`}if(t instanceof Ut){let e=`"${t.packageName}" requires a different macOS version`;return t.requiredVersion&&(e+=` (requires ${t.requiredVersion})`),e}if(t instanceof _e)return t.statusCode?`Network error (HTTP ${t.statusCode}): ${t.message}`:`Network error: ${t.message}`;if(t instanceof It)return`Homebrew not found: ${t.message}`;if(t instanceof Ft){let e=t.packageType??"package";return`${e.charAt(0).toUpperCase()+e.slice(1)} not found: ${t.packageName??t.message}`}if(t instanceof ze){if(t.exitCode===void 0||t.exitCode===null)return"Cancelled";if(t.stderr){let e=cr(t.stderr);if(e){let r=`${e.packageType.charAt(0).toUpperCase()+e.packageType.slice(1)} "${e.packageName}" has been discontinued`;return e.reason&&(r+=`: ${e.reason}`),e.disabledDate&&(r+=` (disabled on ${e.disabledDate})`),r}}return t.stderr??t.message}if(t instanceof G)return t.message;if(t instanceof Error){if(t.name==="AbortError")return"Cancelled";let e=t;if(e.stderr){let r=cr(e.stderr);if(r){let n=`${r.packageType.charAt(0).toUpperCase()+r.packageType.slice(1)} "${r.packageName}" has been discontinued`;return r.reason&&(n+=`: ${r.reason}`),r.disabledDate&&(n+=` (disabled on ${r.disabledDate})`),n}return e.stderr}return t.message}return String(t)}var Ke=require("@raycast/api"),vr=R(require("path")),He=R(require("fs"));var Jn=require("fs/promises"),Sr=require("stream"),Zn=R(Lt()),Yn=R(pr()),Xn=R(Vn()),Qn=R(qn()),Cr=require("stream/promises");var Gn=require("node:timers");async function _r(t){return new Promise(e=>(0,Gn.setTimeout)(e,t))}var ea=(()=>{try{He.default.mkdirSync(Ke.environment.supportPath,{recursive:!0})}catch{q.warn("Failed to create supportPath")}return Ke.environment.supportPath})(),Pr=Ke.environment.supportPath.split(vr.default.sep).find(t=>!!t.startsWith("com.raycast"))??"com.raycast.macos";function ht(t){return vr.default.join(ea,t)}var so=["name","tap","desc","homepage","versions","outdated","caveats","token","version","installed","auto_updates","depends_on","conflicts_with","license","aliases","dependencies","build_dependencies","installed","keg_only","linked_key","pinned"],$r=2,oo=1e3;async function qe(t,e){return t.value?(e?.({url:t.url,bytesDownloaded:0,totalBytes:0,percent:100,complete:!0}),t.value):(t.fetch||(t.fetch=io(t,e).then(r=>(t.value=r,r)).finally(()=>{t.fetch=void 0})),t.fetch)}async function io(t,e){let r;for(let n=0;n<=$r;n++)try{return await co(t,n,e)}catch(a){if(r=a instanceof Error?a:new Error(String(a)),!Ie(a)||n>=$r)throw r;N.warn("Fetch failed, retrying",{url:t.url,attempt:n+1,maxRetries:$r,error:r.message}),await _r(oo*(n+1))}throw r}async function co(t,e,r){let n=Date.now();N.log("Fetching remote",{url:t.url,attempt:e});async function a(){let i=Date.now();N.log("Starting download",{url:t.url});try{let c=await fetch(t.url,{headers:{"Accept-Encoding":"identity"}});if(!c.ok||!c.body)throw new _e(`HTTP ${c.status}: ${c.statusText}`,{statusCode:c.status,url:t.url});let u=c.headers.get("content-length"),l=u?parseInt(u,10):0,f=0;r?.({url:t.url,bytesDownloaded:0,totalBytes:l,percent:0,complete:!1});let g=He.default.createWriteStream(t.cachePath);try{if(r){let m=0,w=100,b=new TransformStream({transform(k,x){f+=k.length;let S=Date.now();if(l>0&&f>=l||S-m>=w){let C=l>0?Math.round(f/l*100):-1;m=S,r({url:t.url,bytesDownloaded:f,totalBytes:l,percent:Math.min(C,100),complete:!1})}x.enqueue(k)}}),$=c.body.pipeThrough(b);await(0,Cr.pipeline)(Sr.Readable.fromWeb($),g)}else await(0,Cr.pipeline)(Sr.Readable.fromWeb(c.body),g)}catch(m){g.destroy();try{He.default.unlinkSync(t.cachePath),N.log("Cleaned up partial cache file",{path:t.cachePath})}catch{}let w=m instanceof Error?m.message:String(m);throw r?.({url:t.url,bytesDownloaded:f,totalBytes:l,percent:-1,complete:!1,error:!0,errorMessage:w}),m}r?.({url:t.url,bytesDownloaded:f,totalBytes:l,percent:100,complete:!0});let y=Date.now()-i,_={path:t.cachePath,url:t.url,downloadDurationMs:y};if(l>0){let m=(l/1024).toFixed(2);_.responseSizeBytes=l,_.responseSizeKb=`${m} KB`}T.useInternalApi&&(_.usingInternalApi=!0),q.log("Cache updated from remote",_)}catch(c){let u=Date.now()-i;N.error("Download failed",{url:t.url,durationMs:u,error:c});let l=c instanceof Error?c.message:String(c);throw r?.({url:t.url,bytesDownloaded:0,totalBytes:0,percent:-1,complete:!1,error:!0,errorMessage:l}),Rt(c)?c:new _e(`Failed to fetch ${t.url}`,{cause:c instanceof Error?c:void 0,url:t.url})}}async function s(){let i,c=0;try{i=await(0,Jn.stat)(t.cachePath);let u=await fetch(t.url,{method:"HEAD"});c=Date.parse(u.headers.get("last-modified")??"")}catch{q.log("Cache miss",{path:t.cachePath})}!i||i.size==0||c>i.mtimeMs?await a():N.log("Using cached data (up to date)",{url:t.url,cacheAgeMs:Date.now()-i.mtimeMs})}async function o(){let i=Date.now();N.log("Parsing cache",{path:t.cachePath});let c=new RegExp(`\\b(${so.join("|")})\\b`);return new Promise((u,l)=>{let f=[],g=0,y=100,_=w=>{r?.({url:t.url,bytesDownloaded:0,totalBytes:0,percent:100,complete:w,phase:"processing",itemsProcessed:f.length,totalItems:w?f.length:void 0})},m=(0,Zn.chain)([He.default.createReadStream(t.cachePath),(0,Yn.parser)(),(0,Xn.filter)({filter:c}),(0,Qn.streamArray)()]);m.on("data",w=>{if(w&&typeof w=="object"&&"value"in w){f.push(w.value);let b=Date.now();r&&b-g>=y&&(g=b,_(!1))}}),m.on("end",()=>{let w=Date.now()-i,b=Date.now()-n;N.log("Fetch completed",{url:t.url,itemCount:f.length,parseDurationMs:w,totalDurationMs:b}),_(!0),u(f)}),m.on("error",w=>{let b=Date.now()-i;q.warn("Cache parse error, removing corrupted cache",{path:t.cachePath,error:w.message,parseDurationMs:b}),He.default.rmSync(t.cachePath),l(new lt("Failed to parse cached data",{cause:w}))})})}return s().then(o)}var J=require("@raycast/api");function mt(t){let e={style:J.Toast.Style.Animated,title:t.title,message:t.message},r;t.cancelable&&(r=new AbortController,e.primaryAction={title:"Cancel",onAction:()=>{r?.abort(),n.hide()}});let n=new J.Toast(e);return n.show(),{abort:r,updateMessage:a=>{n.message=a},updateTitle:a=>{n.title=a},showSuccessHUD:async a=>{T.closeAfterAction?(n.hide(),await(0,J.showHUD)(`\u2705 ${a}`)):(n.style=J.Toast.Style.Success,n.title=a,n.message=void 0,n.primaryAction=void 0)},showFailureHUD:async a=>{T.closeAfterAction?(n.hide(),await(0,J.showHUD)(`\u274C ${a}`)):(n.style=J.Toast.Style.Failure,n.title=a,n.message=void 0,n.primaryAction=void 0)},hide:()=>{n.hide()}}}async function Ue(t,e,r){if(e.name==="AbortError"){re.log("Operation aborted by user");return}let n=e,a=ge(e),s=ie(e);re.error(t,{errorType:e.name,message:e.message,stderr:n.stderr,code:n.code,recoverable:Ie(e),isLockError:s});let o=s?"Brew is Busy":t,i={style:J.Toast.Style.Failure,title:o,message:a,primaryAction:{title:"Copy Logs",onAction:()=>{let u=s?`${o}
${a}

Tip: Check Activity Monitor or run 'ps aux | grep brew' in Terminal to see what's running.`:a;J.Clipboard.copy(u)}}};if(Ie(e)&&r?.retryAction){let u=r.retryAction;i.secondaryAction={title:"Retry",onAction:async l=>{l.style=J.Toast.Style.Animated,l.title="Retrying...",l.message=void 0;try{await u(),l.style=J.Toast.Style.Success,l.title="Success"}catch(f){l.style=J.Toast.Style.Failure,l.title=ie(f)?"Brew is Busy":t,l.message=ge(f)}}}}await new J.Toast(i).show()}Array.prototype.first||(Array.prototype.first=function(){return this.at(0)});Array.prototype.last||(Array.prototype.last=function(){return this.at(-1)});Array.prototype.isTruncated||(Array.prototype.isTruncated=function(){return this.totalLength?this.length<this.totalLength:!1});String.ellipsis||(String.ellipsis="\u2026");var ta=R(ir()),Re=new ta.Logger({prefix:"[Brew]"}).child("[Memory]"),gt={heapPercentWarning:70,heapPercentCritical:85,deltaWarningMB:50};function Ge(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function lo(t){let e=t.match(/at\s+(.+?)\s+\((.+):(\d+):(\d+)\)/);if(e)return{functionName:e[1],fileName:e[2],lineNumber:parseInt(e[3],10),columnNumber:parseInt(e[4],10)};let r=t.match(/at\s+(.+):(\d+):(\d+)/);if(r)return{functionName:"<anonymous>",fileName:r[1],lineNumber:parseInt(r[2],10),columnNumber:parseInt(r[3],10)}}function uo(t=2){let e=new Error().stack;if(!e)return;let n=e.split(`
`)[t+1];if(n)return lo(n)}function fo(t=2,e=5){let r=new Error().stack;return r?r.split(`
`).slice(t+1,t+1+e).map(s=>s.trim()).join(`
`):""}function pt(t,e=!1){let r=process.memoryUsage(),n=r.heapTotal>0?r.heapUsed/r.heapTotal*100:0,a={timestamp:Date.now(),label:t,rss:r.rss,heapTotal:r.heapTotal,heapUsed:r.heapUsed,external:r.external,arrayBuffers:r.arrayBuffers,heapPercent:n,caller:uo(3)};return e&&(a.stack=fo(3)),a}function ho(t,e){return{rss:e.rss-t.rss,heapTotal:e.heapTotal-t.heapTotal,heapUsed:e.heapUsed-t.heapUsed,external:e.external-t.external,arrayBuffers:e.arrayBuffers-t.arrayBuffers}}function mo(t){return t>=gt.heapPercentCritical?"\u{1F534} CRITICAL":t>=gt.heapPercentWarning?"\u26A0\uFE0F HIGH":""}function bt(t){let e=mo(t.heapPercent),r={label:t.label,heapUsed:Ge(t.heapUsed),heapTotal:Ge(t.heapTotal),heapPercent:`${t.heapPercent.toFixed(1)}%`,rss:Ge(t.rss)};if(e&&(r.warning=e),t.caller){let{functionName:n,fileName:a,lineNumber:s}=t.caller,o=a.split("/").slice(-2).join("/");r.caller=`${n} (${o}:${s})`}return t.stack&&(r.stack=t.stack),r}function yt(t,e=!1){let r=pt(t,e);return Re.log(t,bt(r)),r}function po(t,e){e.heapPercent>=gt.heapPercentCritical?Re.error(`${t} - CRITICAL memory usage`,{...bt(e),recommendation:"Consider reducing data size or clearing cache"}):e.heapPercent>=gt.heapPercentWarning&&Re.warn(`${t} - High memory usage`,bt(e))}async function Ar(t,e,r={}){let{includeStack:n=!1,logAlways:a=!0}=r,s=pt(`Before ${t}`,n),o=Date.now();a&&Re.log(`Starting: ${t}`,bt(s));let i;try{i=await e()}catch(y){let _=pt(`Error in ${t}`,!0);throw Re.error(`Memory state at error in ${t}`,{...bt(_),error:y instanceof Error?y.message:String(y)}),y}let c=pt(`After ${t}`,n),u=Date.now()-o,l=ho(s,c),f=l.heapUsed/(1024*1024),g=Math.abs(f)>=gt.deltaWarningMB;return(a||g)&&Re.log(`Completed: ${t}`,{durationMs:u,heapDelta:Ge(l.heapUsed),heapBefore:Ge(s.heapUsed),heapAfter:Ge(c.heapUsed),heapPercent:`${c.heapPercent.toFixed(1)}%`,...g?{warning:`\u26A0\uFE0F Large heap change: ${f.toFixed(1)} MB`}:{}}),po(t,c),{result:i,before:s,after:c,delta:l,durationMs:u}}var ra=require("child_process"),Er=require("path"),na=require("os");var Ot=(()=>{if(T.customBrewPath&&T.customBrewPath.length>0)return(0,Er.join)(T.customBrewPath,"..","..");try{return(0,ra.execSync)("brew --prefix",{encoding:"utf8"}).trim()}catch{return(0,na.cpus)()[0]?.model?.includes("Apple")?"/opt/homebrew":"/usr/local"}})(),de=t=>(0,Er.join)(Ot,t),Se=()=>de("bin/brew");var sa=require("child_process"),oa=require("util"),ia=require("fs"),Nt=R(require("fs/promises")),ca=require("path"),la=require("@raycast/api");var go=(0,oa.promisify)(sa.exec),aa=!1;async function ye(t,e){try{let r=await Bt();return await go(`${Se()} ${t}`,{signal:e?.signal,env:r,maxBuffer:10*1024*1024})}catch(r){let n=r,a=n?.stderr||n?.stdout||"";throw ft(a)?(D.warn("Brew lock detected - another process is running",{command:t,stderr:n?.stderr}),new le("Another brew process is already running",{command:t,cause:n})):T.customBrewPath&&n&&n.code===127?(n.stderr=`Brew executable not found at: ${T.customBrewPath}`,n):r}}async function Bt(){let t=(0,ca.join)(la.environment.assetsPath,"askpass.sh");try{await Nt.access(t,ia.constants.X_OK)}catch{await Nt.chmod(t,493)}let e={...process.env};e.SUDO_ASKPASS=t,e.HOMEBREW_BROWSER=Pr;let r=T.disableDownloadConcurrency;r&&(e.HOMEBREW_DOWNLOAD_CONCURRENCY="1");let n=T.useInternalApi;return n&&(e.HOMEBREW_USE_INTERNAL_API="1"),aa||(aa=!0,D.log("Homebrew 5.0 Configuration",{downloadConcurrencyEnabled:!r,downloadConcurrencyMode:r?"sequential (1)":"parallel (auto)",internalApiEnabled:n,verboseLogging:T.verboseLogging})),e}var ua=require("child_process");var Tr=300*1e3,fa=600*1e3;function da(t){let e=t.trim();if(!e)return null;let r=e.replace(/^=+>\s*/,"");if(e.includes("Downloading"))return{phase:"downloading",message:r};let n=e.match(/#+\s*(\d+\.?\d*)%/);return n?{phase:"downloading",message:`Downloading... ${n[1]}%`,percentage:parseFloat(n[1])}:e.includes("Verifying")||e.includes("checksum")?{phase:"verifying",message:r}:e.includes("Pouring")||e.includes("Extracting")?{phase:"extracting",message:r}:e.includes("Installing")||e.includes("==> Installing")?{phase:"installing",message:r}:e.includes("Linking")||e.includes("==> Linking")?{phase:"linking",message:r}:e.includes("Cleaning")||e.includes("Removing")?{phase:"cleaning",message:r}:e.includes("==> Caveats")||e.includes("==> Summary")?{phase:"complete",message:r}:e.startsWith("==>")?{phase:"installing",message:r}:null}async function wt(t,e,r,n){let a=await Bt(),s=t.split(/\s+/).filter(Boolean),o=n?.staleTimeoutMs??Tr,i=n?.packageName,c=n?.verboseLogging??!1;return D.log("Executing brew with progress",{command:t,packageName:i,staleTimeoutMs:o}),new Promise((u,l)=>{let f=(0,ua.spawn)(Se(),s,{env:a,stdio:["ignore","pipe","pipe"]}),g="",y="",_=Date.now(),m="starting",w=null,b=!1,$=()=>{w&&(clearInterval(w),w=null)},k=S=>{b||(b=!0,$(),f.kill("SIGTERM"),l(S))};w=setInterval(()=>{let p=Date.now()-_,C=m==="downloading"?fa:o;p>C?(D.warn("Stale process detected",{command:t,packageName:i,lastPhase:m,staleDurationMs:p,timeoutMs:C}),k(new $e(`Process appears stuck during ${m}`,{packageName:i,lastPhase:m,staleDurationMs:p}))):c&&D.log("Stale check passed",{command:t,phase:m,timeSinceLastProgress:p,timeout:C})},3e4),r&&r.addEventListener("abort",()=>{if(b)return;b=!0,$(),f.kill("SIGTERM");let S=new Error("Cancelled");S.name="AbortError",l(S)}),e?.({phase:"starting",message:`Running: brew ${t.trim()}`});let x=(S,p)=>{_=Date.now();let C=S.split(`
`);for(let M of C){let A=da(M);A?(A.phase!==m&&(D.log("Phase transition",{command:t,packageName:i,from:m,to:A.phase,message:A.message}),m=A.phase),e?.(A)):c&&M.trim()&&D.log(`Unparsed ${p}`,{line:M.trim()})}};f.stdout?.on("data",S=>{let p=S.toString();g+=p,x(p,"stdout")}),f.stderr?.on("data",S=>{let p=S.toString();if(y+=p,ft(p)){k(new le("Another brew process is already running",{command:t}));return}x(p,"stderr")}),f.on("close",S=>{$(),!b&&(D.log("Command completed",{command:t,packageName:i,exitCode:S,finalPhase:m}),S===0?(e?.({phase:"complete",message:"Operation completed successfully"}),u({stdout:g,stderr:y})):(e?.({phase:"error",message:`Command failed with exit code ${S}`}),l(new ze(`brew ${t} failed with exit code ${S}`,{command:t,exitCode:S??void 0,stderr:y}))))}),f.on("error",S=>{$(),!b&&(e?.({phase:"error",message:S.message}),l(S))})})}var we=R(require("fs/promises")),Pa=require("child_process");var Vt=require("os"),ba=require("child_process"),me=R(require("fs")),ya=R(Lt()),wa=R(pr()),ka=R(ma()),xa=R(ga());var xo={15:"sequoia",14:"sonoma",13:"ventura",12:"monterey",11:"big_sur"},_o={tahoe:26},kt=null,he=null;function jt(){if(kt)return kt;let t=_a(),e=So();return kt=`${t}_${e}`,N.log("Detected system tag",{systemTag:kt,architecture:t,macOSVersion:e}),kt}function _a(){if(process.arch==="arm64")return"arm64";if(process.arch==="x64")return"x86_64";try{let t=(0,Vt.cpus)();if(!t||t.length===0)return N.warn("No CPUs detected, defaulting to x86_64"),"x86_64";let e=t[0];return!e||typeof e.model!="string"?(N.warn("CPU model is not a string, defaulting to x86_64",{cpuModel:typeof e?.model}),"x86_64"):e.model.includes("Apple")?"arm64":(e.model.includes("Intel")||N.warn("Unknown CPU model, defaulting to x86_64",{cpuModel:e.model}),"x86_64")}catch(t){return N.warn("CPU detection failed, defaulting to x86_64",{error:t instanceof Error?t.message:String(t)}),"x86_64"}}function $o(){if(he!==null)return he;let t=process.env.HOMEBREW_MACOS_VERSION;if(t){let r=parseInt(t,10);if(!isNaN(r)&&r>=11&&r<=30)return he=r,he}try{let r=(0,ba.execSync)("sw_vers -productVersion",{encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim(),n=parseInt(r.split(".")[0],10);if(!isNaN(n)&&n>=11)return he=n,he}catch{}try{let r=(0,Vt.release)(),n=parseInt(r.split(".")[0],10);if(!isNaN(n)&&n>=20)return he=n-9,he}catch{}return he=_a()==="arm64"?15:14,he}function So(){let t=$o(),e=xo[t];if(e)return e;for(let[r,n]of Object.entries(_o))if(t===n)return r;return t>15?(N.warn("Unknown macOS version, using sequoia as fallback",{detectedVersion:t}),"sequoia"):(N.warn("Unsupported macOS version detected",{detectedVersion:t,minimumSupported:11}),"big_sur")}var $a="https://formulae.brew.sh/api/internal";function Ir(){let t=jt();return`${$a}/formula.${t}.jws.json`}function Sa(){let t=jt();return`${$a}/cask.${t}.jws.json`}async function Ca(t,e){let r=Ir(),n=Date.now(),a=t+".jws.tmp";N.log("Downloading internal formulae API for cache",{url:r,cachePath:t}),await Ar("downloadAndCacheInternalFormulae",async()=>{e?.({url:r,bytesDownloaded:0,totalBytes:0,percent:0,complete:!1,phase:"downloading"});let s=await fetch(r);if(!s.ok||!s.body)throw new Error(`HTTP ${s.status}: ${s.statusText}`);let o=s.headers.get("content-length"),i=o?parseInt(o,10):0,c=0,u=0,l=100,f=me.createWriteStream(a),g=s.body.getReader();for(;;){let{done:b,value:$}=await g.read();if(b)break;f.write(Buffer.from($)),c+=$.length;let k=Date.now();if(k-u>=l){u=k;let x=i>0?Math.round(c/i*100):-1;e?.({url:r,bytesDownloaded:c,totalBytes:i,percent:x,complete:!1,phase:"downloading"})}}await new Promise((b,$)=>{f.end(k=>{k?$(k):b()})}),yt("After formulae download to disk"),e?.({url:r,bytesDownloaded:c,totalBytes:i,percent:100,complete:!1,phase:"processing"});let y=t+".payload.tmp";await Co(a,y),yt("After JWS payload extraction to disk");let _=0,m=me.createWriteStream(t);m.write("["),await new Promise((b,$)=>{let k=(0,ya.chain)([me.createReadStream(y),(0,wa.parser)(),(0,ka.pick)({filter:"formulae"}),(0,xa.streamObject)()]),x=!0;k.on("data",S=>{if(S&&S.key&&S.value){let p=vo(S.key,S.value);x?(m.write(`
`),x=!1):m.write(`,
`),m.write(JSON.stringify(p)),_++;let C=Date.now();C-u>=l&&(u=C,e?.({url:r,bytesDownloaded:c,totalBytes:i,percent:100,complete:!1,phase:"processing",itemsProcessed:_}))}}),k.on("end",()=>{m.write(`
]`),m.end(S=>{S?$(S):b()})}),k.on("error",$)});try{me.unlinkSync(a),me.unlinkSync(y)}catch{}yt("After formulae cache write (streaming)");let w=Date.now()-n;N.log("Internal formulae cached",{url:r,cachePath:t,count:_,durationMs:w,downloadBytes:c}),e?.({url:r,bytesDownloaded:c,totalBytes:i,percent:100,complete:!0,phase:"processing",itemsProcessed:_,totalItems:_})},{logAlways:!0})}async function Co(t,e){return new Promise((r,n)=>{let a=me.createReadStream(t,{encoding:"utf8",highWaterMark:16384}),s=me.createWriteStream(e,{highWaterMark:16*1024}),o="searching",i="",c="",u=!1,l=[],f=0,g=8*1024,y=()=>{l.length>0&&(s.write(l.join("")),l.length=0,f=0)},_=w=>{l.push(w),f+=w.length,f>=g&&y()},m='"payload":"';a.on("data",w=>{let b=typeof w=="string"?w:w.toString("utf8");if(o==="done")return;let $=-1;for(let k=0;k<b.length;k++){let x=b[k];if(o==="searching")i+=x,i.length>m.length&&(i=i.slice(-m.length)),i===m&&(o="in_payload",i="");else if(o==="in_payload")if(u)u=!1,x==="n"?_(`
`):x==="r"?_("\r"):x==="t"?_("	"):x==='"'?_('"'):x==="\\"?_("\\"):x==="/"?_("/"):x==="u"?c="\\u":_(x);else if(c.length>0){if(c+=x,c.length===6){try{let S=parseInt(c.slice(2),16);_(String.fromCharCode(S))}catch{_(c)}c=""}}else if(x==="\\")$>=0&&(_(b.slice($,k)),$=-1),u=!0;else if(x==='"'){$>=0&&(_(b.slice($,k)),$=-1),o="done",y(),s.end(),r();return}else $<0&&($=k)}o==="in_payload"&&$>=0&&_(b.slice($))}),a.on("end",()=>{o!=="done"&&(y(),s.end(),o==="searching"?n(new Error("No payload found in JWS file")):r())}),a.on("error",w=>{s.end(),n(w)}),s.on("error",n)})}function vo(t,e){let[r,,,,n]=e;return{name:t,tap:"homebrew/core",homepage:"",versions:{stable:r,bottle:!0},outdated:!1,license:null,aliases:[],dependencies:n||[],build_dependencies:[],installed:[],keg_only:!1,linked_key:"",pinned:!1}}function Fr(){let t=jt(),e=Ir(),r=Sa();q.log("Internal API configuration",{systemTag:t,formulaUrl:e,caskUrl:r})}var Je=ht("installedv2.json"),Wt=ht("formula.json"),Aa=ht("cask.json"),Po="https://formulae.brew.sh/api/formula.json",Ao="https://formulae.brew.sh/api/cask.json",Dr={url:Po,cachePath:Wt},Eo={url:Ao,cachePath:Aa};async function Mr(){try{let[t,e]=await Promise.all([we.stat(Wt),we.stat(Aa)]);return t.size>0&&e.size>0}catch{return!1}}async function Ur(t,e){let r=Date.now(),n=await To(t,e),a=Io(n),s=Date.now()-r;return a&&D.log("Installed packages fetched",{formulaeCount:a.formulae.size,casksCount:a.casks.size,totalCount:a.formulae.size+a.casks.size,durationMs:s,fromCache:t}),a}async function To(t,e){async function r(){return(await ye("info --json=v2 --installed",e?{signal:e}:void 0)).stdout}if(!t)return JSON.parse(await r());async function n(){let o=Date.now(),i=await r(),c=JSON.parse(i),u=Date.now()-o;try{await we.writeFile(Je,i);let l=Buffer.byteLength(i,"utf8"),f=(l/1024).toFixed(2);q.log("Updated installed cache",{path:Je,formulaeCount:c.formulae.length,casksCount:c.casks.length,totalCount:c.formulae.length+c.casks.length,durationMs:u,responseSizeBytes:l,responseSizeKb:`${f} KB`,usingInternalApi:T.useInternalApi})}catch(l){q.error("Failed to write installed cache",{path:Je,formulaeCount:c.formulae.length,casksCount:c.casks.length,error:l})}return c}async function a(o){return(await we.stat(o)).mtimeMs}async function s(){let o=await a(Je),i=await a(de("var/homebrew/locks")),c=await a(de("Caskroom")),u;try{u=await a(de("var/homebrew/pinned"))}catch{u=0}let l=await a(de("var/homebrew"));if(l<o&&c<o&&i<o&&u<o){let f=await we.readFile(Je),g=JSON.parse(f.toString());return q.log("Using cached installed data",{path:Je,formulaeCount:g.formulae.length,casksCount:g.casks.length,totalCount:g.formulae.length+g.casks.length,cacheAgeMs:Date.now()-o}),g}else return q.log("Cache invalidated, refreshing",{reason:"brew state changed",homebrewTime:l,caskroomTime:c,locksTime:i,pinnedTime:u,cacheTime:o}),await n()}try{return await s()}catch{return await n()}}function Io(t){if(!t)return;let e=new Map;for(let n of t.formulae)e.set(n.name,n);let r=new Map;for(let n of t.casks)r.set(n.token,n);return{formulae:e,casks:r}}var va=!1,xt=null;async function Fo(t,e){try{let r=await we.stat(e);if(r.size===0)return!0;let n=await fetch(t,{method:"HEAD"}),a=Date.parse(n.headers.get("last-modified")??"");return a>r.mtimeMs?(q.log("Internal API cache outdated",{cachePath:e,cacheTime:r.mtimeMs,remoteTime:a}),!0):(q.log("Internal API cache up to date",{cachePath:e,cacheAgeMs:Date.now()-r.mtimeMs}),!1)}catch{return!0}}async function Rr(t){if(T.useInternalApi){va||(Fr(),va=!0);try{let e="https://formulae.brew.sh/api/internal/formula."+Do()+".jws.json";if(await Fo(e,Wt))if(xt)D.log("Waiting for existing formulae cache update to complete"),await xt;else{D.log("Updating formulae cache from internal API"),xt=Ca(Wt,t);try{await xt}finally{xt=null}}return await qe(Dr,t)}catch(e){return D.warn("Internal formulae API failed, falling back to public API",{error:e instanceof Error?e.message:String(e)}),await qe(Dr,t)}}return await qe(Dr,t)}async function Lr(t){return await qe(Eo,t)}function Do(){let t=process.arch==="arm64"?"arm64":"x86_64",e="sequoia";try{let r=(0,Pa.execSync)("sw_vers -productVersion",{encoding:"utf8",timeout:5e3,stdio:["pipe","pipe","pipe"]}).trim(),n=parseInt(r.split(".")[0],10);e={15:"sequoia",14:"sonoma",13:"ventura",12:"monterey",11:"big_sur"}[n]||"sequoia"}catch{}return`${t}_${e}`}async function Or(t,e){let r=Date.now();D.log("Fetching formula info",{name:t});try{let n=await ye(`info --json=v2 ${t}`,e?{signal:e}:void 0),a=JSON.parse(n.stdout),s=Date.now()-r;if(a.formulae.length>0)return D.log("Formula info fetched",{name:t,durationMs:s}),a.formulae[0];D.warn("Formula not found",{name:t,durationMs:s});return}catch(n){D.error("Failed to fetch formula info",{name:t,error:n});return}}async function Nr(t,e){let r=Date.now();D.log("Fetching cask info",{token:t});try{let n=await ye(`info --json=v2 ${t}`,e?{signal:e}:void 0),a=JSON.parse(n.stdout),s=Date.now()-r;if(a.casks.length>0)return D.log("Cask info fetched",{token:t,durationMs:s}),a.casks[0];D.warn("Cask not found",{token:t,durationMs:s});return}catch(n){D.error("Failed to fetch cask info",{token:t,error:n});return}}var _t=require("path");function ae(t){return t.token!==void 0}function Ce(t){return ae(t)?t.token:t.name}function z(t){return ae(t)?t.name&&t.name[0]?t.name[0]:"Unknown":t.name}function ve(t,e=!1){return ae(t)?"--cask"+(e&&T.zapCask?" --zap":""):""}function ke(t){return ae(t)?Mo(t):Uo(t)}function Mo(t){return t.installed?t.installed.length>0:!1}function Uo(t){return t.installed.length>0}function zt(t){return ae(t)?Ro(t):Lo(t)}function Ro(t){let e=de((0,_t.join)("Caskroom",t.token));return t.installed?(0,_t.join)(e,t.installed):e}function Lo(t){let e=de((0,_t.join)("Cellar",t.name)),r=t.installed[0];return r?(0,_t.join)(e,r.version):e}function Ht(t){return ae(t)?Oo(t):No(t)}function Oo(t){if(!t.installed)return"";let e=t.installed;return t.outdated&&(e+=" (O)"),e}function No(t){let e=t.installed[0];if(!e)return"";let r=e.version,n="";return e.installed_as_dependency&&(n+="D"),t.pinned&&(n+="P"),t.outdated&&(n+="O"),n&&(r+=` (${n})`),r}function Kt(t,e,r){let n=t.toLowerCase().includes(r),a=e.toLowerCase().includes(r);return n&&!a?-1:a&&!n?1:t.localeCompare(e)}function Ze(t){let e=Ce(t);return`${Se()} install ${ve(t)} ${e}`.replace(/ +/g," ")}function Ye(t){let e=Ce(t);return`${Se()} uninstall ${ve(t,!0)} ${e}`.replace(/ +/g," ")}var Br;async function Vr(t,e,r,n){oe.log("Searching",{query:t,limit:e}),Br=t;let a,s;n?.({phase:"casks"});let o=await Lr(l=>{a=l,n?.({phase:"casks",casksProgress:l,formulaeProgress:s})});if(r?.aborted){let l=new Error("Aborted");throw l.name="AbortError",l}n?.({phase:"formulae",casksProgress:a,formulaeProgress:s});let i=await Rr(l=>{s=l,n?.({phase:"formulae",casksProgress:a,formulaeProgress:l})});if(r?.aborted){let l=new Error("Aborted");throw l.name="AbortError",l}if(Br.length>0){let l=Br.toLowerCase();i=i?.filter(f=>f.name.toLowerCase().includes(l)||f.desc?.toLowerCase().includes(l)).sort((f,g)=>Kt(f.name,g.name,l)),o=o?.filter(f=>f.token.toLowerCase().includes(l)||f.name.some(g=>g.toLowerCase().includes(l))||f.desc?.toLowerCase().includes(l)).sort((f,g)=>Kt(f.token,g.token,l))}let c=i.length,u=o.length;return e&&(i=i.slice(0,e),o=o.slice(0,e)),i.totalLength=c,o.totalLength=u,oe.log("Search completed",{query:t,formulaeResults:i.length,casksResults:o.length,totalFormulae:c,totalCasks:u,truncated:i.length<c||o.length<u}),n?.({phase:"complete",formulaeProgress:s?{...s,totalItems:c}:void 0,casksProgress:a?{...a,totalItems:u}:void 0}),{formulae:i,casks:o}}async function jr(t,e,r){let n=Ce(t),a=ae(t);Q.log("Installing package with progress",{identifier:n,type:a?"cask":"formula"}),await wt(`install ${ve(t)} ${n}`,e,r),a?t.installed=t.version:t.installed=[{version:t.versions.stable,installed_as_dependency:!1,installed_on_request:!0}],Q.log("Package installed successfully",{identifier:n})}async function Wr(t,e){let r=Ce(t);Q.log("Uninstalling package",{identifier:r,type:ae(t)?"cask":"formula",zap:T.zapCask}),await ye(`rm ${ve(t,!0)} ${r}`,e?{signal:e}:void 0),Q.log("Package uninstalled successfully",{identifier:r})}async function zr(t,e,r){let n=Ce(t);Q.log("Upgrading package with progress",{identifier:n,type:ae(t)?"cask":"formula"}),await wt(`upgrade ${ve(t)} ${n}`,e,r),Q.log("Package upgraded successfully",{identifier:n})}async function Hr(t){Q.log("Pinning formula",{name:t.name}),await ye(`pin ${t.name}`),t.pinned=!0,Q.log("Formula pinned successfully",{name:t.name})}async function Kr(t){Q.log("Unpinning formula",{name:t.name}),await ye(`unpin ${t.name}`),t.pinned=!1,Q.log("Formula unpinned successfully",{name:t.name})}function Ta(){let t=(0,Ea.useRef)(void 0),e=je(async()=>await Ur(!0),[],{keepPreviousData:!0,onWillExecute:async()=>{t.current=await(0,Xe.showToast)({style:Xe.Toast.Style.Animated,title:"Loading Installed Packages\u2026"})},onData:()=>{t.current?.hide()},onError:async r=>{t.current?.hide(),D.error("Failed to fetch installed packages",{errorType:r.name,message:r.message,isLockError:ie(r)});let n=ie(r),a=ge(r);await(0,Xe.showToast)({style:Xe.Toast.Style.Failure,title:n?"Brew is Busy":"Failed to fetch installed packages",message:n?"Another brew process is running. Please wait and try again.":a,primaryAction:{title:"Retry",onAction:s=>{s.hide(),e.revalidate()}}})}});return e}var X=require("react"),qt=require("@raycast/api");var Wo={started:!1,complete:!1,bytesDownloaded:0,totalBytes:0,percent:0,itemsProcessed:0,totalItems:0};function Ia(t){let{searchText:e,limit:r=200,installed:n}=t,a=(0,X.useRef)(!1),[s,o]=(0,X.useState)(null);(0,X.useEffect)(()=>{let p=new AbortController;return Mr().then(C=>{p.signal.aborted||(o(C),oe.log("Cache check complete",{cacheExists:C}))}).catch(C=>{C.name!=="AbortError"&&oe.error("Cache check failed",{error:C instanceof Error?C.message:String(C)})}),()=>{p.abort()}},[]);let[i,c]=(0,X.useState)({phase:"casks"}),u=(0,X.useRef)(0),l=100,f=(0,X.useRef)(null),{isLoading:g,data:y,mutate:_}=je(async p=>(oe.log("Starting search",{query:p,isInitialLoad:!a.current}),c({phase:"casks"}),u.current=0,await Vr(p,r,f.current?.signal,M=>{try{if(f.current?.signal.aborted)return;let A=Date.now(),it=M.phase==="complete",ee=M.casksProgress?.complete===!0,B=M.formulaeProgress?.complete===!0;(it||ee||B||A-u.current>=l)&&(u.current=A,c(M))}catch(A){oe.error("Progress callback error",{error:A instanceof Error?A.message:String(A)})}})),[e],{abortable:f,keepPreviousData:!0,onError:async p=>{if(p.name==="AbortError")return;oe.error("Search failed",{errorType:p.name,message:p.message,isLockError:ie(p)});let C=ie(p),M=ge(p);await(0,qt.showToast)({style:qt.Toast.Style.Failure,title:C?"Brew is Busy":"Search failed",message:C?"Another brew process is running. Please wait and try again.":M})}});(0,X.useEffect)(()=>{y&&!a.current&&(oe.log("Initial data loaded",{formulaeCount:y.formulae.length,casksCount:y.casks.length}),a.current=!0)},[y]);let m=(0,X.useMemo)(()=>{if(!y)return;let p=y.formulae.map(A=>({...A})),C=y.casks.map(A=>({...A}));p.totalLength=y.formulae.totalLength,C.totalLength=y.casks.totalLength;let M={formulae:p,casks:C};return zo(M,n),M},[y,n]),w=!a.current&&!y,b=g||w,$=p=>p?{started:!0,complete:p.complete,bytesDownloaded:p.bytesDownloaded,totalBytes:p.totalBytes,percent:p.percent,itemsProcessed:p.itemsProcessed??0,totalItems:p.totalItems??0}:Wo,k=(0,X.useMemo)(()=>{let p=$(i.casksProgress),C=$(i.formulaeProgress);return p.started=!0,(i.phase==="formulae"||i.phase==="parsing"||i.phase==="complete")&&(C.started=!0),i.phase==="formulae"||i.phase==="parsing"||i.phase==="complete"?(p.complete=!0,p.percent=100):p.complete=!1,i.phase==="parsing"||i.phase==="complete"?(C.complete=!0,C.percent=100):i.phase==="formulae"&&(C.complete=!1),{isLoading:b,isInitialLoad:w,phase:i.phase,casksProgress:p,formulaeProgress:C}},[b,w,i]),x=s,S=(0,X.useMemo)(()=>{let p=i.casksProgress?.totalItems,C=i.formulaeProgress?.totalItems;if(p!==void 0&&C!==void 0&&p>0&&C>0)return{formulae:C,casks:p};if(y){let M=y.formulae.totalLength??y.formulae.length,A=y.casks.totalLength??y.casks.length;if(M>0||A>0)return{formulae:M,casks:A}}},[i.casksProgress?.totalItems,i.formulaeProgress?.totalItems,y]);return{isLoading:b,isInitialLoad:w,hasCacheFiles:x,loadingState:k,data:m,mutate:_,indexTotals:S}}function zo(t,e){if(!(!t||!e)){for(let r of t.formulae){let n=e.formulae instanceof Map?e.formulae.get(r.name):void 0;n&&Ko(n)?(r.installed=n.installed,r.outdated=n.outdated,r.pinned=n.pinned):(r.installed=[],r.outdated=!1,r.pinned=!1)}for(let r of t.casks){let n=e.casks instanceof Map?e.casks.get(r.token):void 0;n&&Ho(n)?(r.installed=n.installed,r.outdated=n.outdated):(r.installed=void 0,r.outdated=!1)}}}function Ho(t){return t.token!=null}function Ko(t){return t.pinned!=null}function Fa(t,e){return e?e.formulae instanceof Map&&e.formulae.get(t)!=null||e.casks instanceof Map&&e.casks.get(t)!=null:!1}var $t=require("@raycast/api"),Qe=require("react/jsx-runtime");function Da(t){return(0,Qe.jsxs)($t.List.Dropdown,{tooltip:"Filter by formula or cask",onChange:e=>{t.onSelect(e)},storeValue:!0,children:[(0,Qe.jsx)($t.List.Dropdown.Item,{value:"all",title:"All"}),(0,Qe.jsx)($t.List.Dropdown.Item,{value:"formulae",title:"Formulae"}),(0,Qe.jsx)($t.List.Dropdown.Item,{value:"casks",title:"Casks"})]})}function Ma(t){return`Search ${t==="all"?"formulae or casks":t==="casks"?"casks":"formulae"} by name${String.ellipsis}`}var O=require("@raycast/api");var h=require("@raycast/api");var St=require("@raycast/api");var Pe={alacritty:"Alacritty",ghostty:"Ghostty",hyper:"Hyper",iterm:"iTerm",kitty:"kitty",terminal:"Terminal",warp:"Warp",wezterm:"WezTerm"},Ua={alacritty:{fileIcon:"/Applications/Alacritty.app"},ghostty:{fileIcon:"/Applications/Ghostty.app"},hyper:{fileIcon:"/Applications/Hyper.app"},iterm:{fileIcon:"/Applications/iTerm.app"},kitty:{fileIcon:"/Applications/kitty.app"},terminal:{fileIcon:"/System/Applications/Utilities/Terminal.app"},warp:{fileIcon:"/Applications/Warp.app"},wezterm:{fileIcon:"/Applications/WezTerm.app"}},qo={alacritty:"org.alacritty",ghostty:"com.mitchellh.ghostty",hyper:"co.zeit.hyper",iterm:"com.googlecode.iterm2",kitty:"org.kovidgoyal.kitty",terminal:"com.apple.terminal",warp:"dev.warp.Warp-Stable",wezterm:"com.github.wez.wezterm"},et=(t,e)=>`
    tell application "${e}" to activate
    tell application "System Events" to tell process "${e}"
        keystroke "t" using command down
        delay 0.5
        keystroke "${t}"
        keystroke return
    end tell
  `,Ra={alacritty:t=>et(t,Pe.alacritty),ghostty:t=>et(t,Pe.ghostty),hyper:t=>et(t,Pe.hyper),iterm:t=>`
    tell application "iTerm"
      set newWindow to create window with default profile command "bash -c '${t}; read -n 1 -s -r -p \\"Press any key to exit - will not quit\\" ; echo' ; exit"
    end tell
    `,kitty:t=>et(t,Pe.kitty),terminal:t=>`
    tell application "Terminal"
      do shell script "open -a 'Terminal'"
      do script "echo ; ${t} ; bash -c 'read -n 1 -s -r -p \\"Press any key to exit - will not quit\\"' ; exit" in selected tab of the front window
    end tell
  `,warp:t=>et(t,Pe.warp),wezterm:t=>et(t,Pe.wezterm)},Gt=()=>{let{data:t}=je(async e=>(await(0,St.getApplications)()).some(n=>n.bundleId?.toLowerCase()===qo[e].toLowerCase()),[T.terminalApp],{failureToastOptions:{title:"Failed to check if Terminal App is installed"}});return{terminalIcon:t?Ua[T.terminalApp]:Ua.terminal,terminalName:t?Pe[T.terminalApp]:Pe.terminal,runCommandInTerminal:async e=>{await(0,St.closeMainWindow)(),await new Promise(n=>setTimeout(n,400));let r=t?Ra[T.terminalApp](e):Ra.terminal(e);await bn(r),await(0,St.closeMainWindow)()}}};var F=require("@raycast/api");var La=()=>ar("exclude-dependencies",!1);var tt=require("react/jsx-runtime");function qr(t){return(0,tt.jsx)(F.Action,{title:"Install",icon:F.Icon.Plus,shortcut:{modifiers:["cmd"],key:"i"},onAction:async()=>{t.onAction(await Go(t.formula))}})}function Gr(t){return(0,tt.jsx)(F.Action,{title:"Uninstall",icon:F.Icon.Trash,shortcut:F.Keyboard.Shortcut.Common.Remove,style:F.Action.Style.Destructive,onAction:async()=>{let e=await Jo(t.formula);t.onAction(e)}})}function Jr(t){return(0,tt.jsx)(F.Action,{title:"Upgrade",icon:F.Icon.Hammer,shortcut:{modifiers:["cmd","shift"],key:"u"},onAction:async()=>{let e=await Zo(t.formula);t.onAction(e)}})}function Oa(t){let e=t.formula.pinned;return(0,tt.jsx)(F.Action,{title:e?"Unpin":"Pin",icon:F.Icon.Pin,shortcut:F.Keyboard.Shortcut.Common.Pin,onAction:async()=>{e?t.onAction(await Xo(t.formula)):t.onAction(await Yo(t.formula))}})}function Na(t){let[e,r]=La();return(0,tt.jsx)(F.Action,{title:e?"Show Dependencies":"Hide Dependencies",icon:e?F.Icon.Eye:F.Icon.EyeDisabled,shortcut:{modifiers:["cmd"],key:"d"},onAction:()=>{let n=Qo(e,r);t.onAction(n)}})}async function Go(t){let e=z(t),r=mt({title:`Installing ${e}`,message:"",cancelable:!0});try{return await jr(t,n=>{r.updateMessage(n.message)},r.abort?.signal),await r.showSuccessHUD(`Installed ${e}`),!0}catch(n){let a=ne(n);return await r.showFailureHUD(`Failed to install ${e}`),Ue("Install failed",a),!1}}async function Jo(t){let e=z(t),r=mt({title:`Uninstalling ${e}`,message:"",cancelable:!0});try{return await Wr(t,r.abort?.signal),await r.showSuccessHUD(`Uninstalled ${e}`),!0}catch(n){let a=ne(n);return await r.showFailureHUD(`Failed to uninstall ${e}`),Ue("Uninstall failed",a),!1}}async function Zo(t){let e=z(t),r=mt({title:`Upgrading ${e}`,message:"",cancelable:!0});try{return await zr(t,n=>{r.updateMessage(n.message)},r.abort?.signal),await r.showSuccessHUD(`Upgraded ${e}`),!0}catch(n){let a=ne(n);return await r.showFailureHUD(`Failed to upgrade ${e}`),Ue("Upgrade failed",a),!1}}async function Yo(t){(0,F.showToast)(F.Toast.Style.Animated,`Pinning ${z(t)}`);try{return await Hr(t),t.pinned=!0,(0,F.showToast)(F.Toast.Style.Success,`Pinned ${z(t)}`),!0}catch(e){return Ue("Pin formula failed",ne(e)),!1}}async function Xo(t){(0,F.showToast)(F.Toast.Style.Animated,`Unpinning ${z(t)}`);try{return await Kr(t),t.pinned=!1,(0,F.showToast)(F.Toast.Style.Success,`Unpinned ${z(t)}`),!0}catch(e){return Ue("Unpin formula failed",ne(e)),!1}}function Qo(t,e){return e(!t),!0}var at=require("react"),j=require("@raycast/api");var rt=require("@raycast/api"),Zr=require("react/jsx-runtime");function nt({title:t,dependencies:e,isInstalled:r}){return!e||e.length===0?null:(0,Zr.jsx)(rt.Detail.Metadata.TagList,{title:t,children:e.map(n=>(0,Zr.jsx)(rt.Detail.Metadata.TagList.Item,{text:n,color:r(n)?rt.Color.Green:rt.Color.SecondaryText},n))})}var Z=require("react/jsx-runtime");function Ba(t){return!t.homepage||!t.tap||!t.desc}function Yr({cask:t,isInstalled:e,onAction:r}){let{pop:n}=(0,j.useNavigation)(),[a,s]=(0,at.useState)(t),[o,i]=(0,at.useState)(!1);return(0,at.useEffect)(()=>{re.log("Viewing cask info",{token:t.token,name:z(t),hasMinimalData:Ba(t),installed:t.installed,version:t.version})},[t]),(0,at.useEffect)(()=>{if(!Ba(t))return;(async()=>{i(!0);let u=await(0,j.showToast)({style:j.Toast.Style.Animated,title:`Loading ${z(t)} info...`}),l=new AbortController,f=setTimeout(()=>l.abort(),1e4);try{let g=await Nr(t.token,l.signal);clearTimeout(f),g?(t.installed&&(g.installed=t.installed),s(g),re.log("Cask info loaded",{token:g.token,name:z(g),desc:g.desc?.substring(0,50)}),u.hide()):(u.style=j.Toast.Style.Failure,u.title="Failed to load cask info")}catch(g){clearTimeout(f);let y=ne(g).name==="AbortError";re.error("Failed to load cask info",{token:t.token,error:g,timeout:y}),u.style=j.Toast.Style.Failure,u.title=y?"Cask info load timed out":"Failed to load cask info"}finally{i(!1)}})()},[t]),(0,Z.jsx)(j.Detail,{isLoading:o,markdown:ni(a),navigationTitle:`Cask Info: ${z(a)}`,metadata:(0,Z.jsxs)(j.Detail.Metadata,{children:[a.homepage?(0,Z.jsx)(j.Detail.Metadata.Link,{title:"Homepage",text:a.homepage,target:a.homepage}):(0,Z.jsx)(j.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),(0,Z.jsx)(j.Detail.Metadata.Label,{title:"Tap",text:a.tap||"Loading..."}),(0,Z.jsx)(ri,{cask:a}),(0,Z.jsx)(ti,{cask:a}),(0,Z.jsx)(nt,{title:"Conflicts With",dependencies:a.conflicts_with?.cask,isInstalled:e}),(0,Z.jsx)(j.Detail.Metadata.Label,{title:"Auto Updates",text:a.auto_updates?"Yes":"No"})]}),actions:(0,Z.jsx)(Jt,{cask:a,showDetails:!1,isInstalled:e,onAction:c=>{n(),r(c)}})})}function ti({cask:t}){let e=t.depends_on?.macos;return e?(0,Z.jsx)(j.Detail.Metadata.TagList,{title:"macOS Version",children:Object.keys(e).map(r=>{let n=e[r];return n?(0,Z.jsx)(j.Detail.Metadata.TagList.Item,{text:`${r} ${n.join(", ")}`},r):null})}):null}function ri({cask:t}){let e=t.installed?`${t.installed} (installed)`:t.version;return e?(0,Z.jsx)(j.Detail.Metadata.Label,{title:"Version",text:e}):null}function ni(t){return`
# ${z(t)}
${t.desc}

${ai(t)}
  `}function ai(t){return t.caveats?`#### Caveats
${t.caveats}
    `:""}var st=require("react"),W=require("@raycast/api");var Y=require("react/jsx-runtime");function Va(t){return!t.homepage||!t.tap||!t.desc}function Xr(t){let{pop:e}=(0,W.useNavigation)(),[r,n]=(0,st.useState)(t.formula),[a,s]=(0,st.useState)(!1);return(0,st.useEffect)(()=>{re.log("Viewing formula info",{name:t.formula.name,hasMinimalData:Va(t.formula),installed:t.formula.installed?.length>0,version:t.formula.versions.stable})},[t.formula]),(0,st.useEffect)(()=>{if(!Va(t.formula))return;(async()=>{s(!0);let i=await(0,W.showToast)({style:W.Toast.Style.Animated,title:`Loading ${t.formula.name} info...`}),c=new AbortController,u=setTimeout(()=>c.abort(),1e4);try{let l=await Or(t.formula.name,c.signal);clearTimeout(u),l?(t.formula.installed?.length>0&&(l.installed=t.formula.installed),n(l),re.log("Formula info loaded",{name:l.name,desc:l.desc?.substring(0,50),dependencies:l.dependencies?.length??0}),i.hide()):(i.style=W.Toast.Style.Failure,i.title="Failed to load formula info")}catch(l){clearTimeout(u);let f=ne(l).name==="AbortError";re.error("Failed to load formula info",{name:t.formula.name,error:l,timeout:f}),i.style=W.Toast.Style.Failure,i.title=f?"Formula info load timed out":"Failed to load formula info"}finally{s(!1)}})()},[t.formula]),(0,Y.jsx)(W.Detail,{isLoading:a,markdown:si(r),metadata:(0,Y.jsxs)(W.Detail.Metadata,{children:[r.homepage?(0,Y.jsx)(W.Detail.Metadata.Link,{title:"Homepage",text:r.homepage,target:r.homepage}):(0,Y.jsx)(W.Detail.Metadata.Label,{title:"Homepage",text:"Loading..."}),r.license&&(0,Y.jsx)(W.Detail.Metadata.Label,{title:"License",text:r.license}),(0,Y.jsx)(W.Detail.Metadata.Label,{title:"Versions",text:oi(r)}),r.versions.head&&(0,Y.jsx)(W.Detail.Metadata.Label,{title:"",text:r.versions.head}),(0,Y.jsx)(nt,{title:"Dependencies",dependencies:r.dependencies,isInstalled:t.isInstalled}),(0,Y.jsx)(nt,{title:"Build Dependencies",dependencies:r.build_dependencies,isInstalled:t.isInstalled}),(0,Y.jsx)(nt,{title:"Conflicts With",dependencies:r.conflicts_with,isInstalled:t.isInstalled}),r.pinned&&(0,Y.jsx)(W.Detail.Metadata.Label,{title:"Pinned",text:"Yes"}),r.keg_only&&(0,Y.jsx)(W.Detail.Metadata.Label,{title:"Keg Only",text:"Yes"})]}),actions:(0,Y.jsx)(Zt,{formula:r,showDetails:!1,isInstalled:t.isInstalled,onAction:o=>{e(),t.onAction(o)}})})}function si(t){return`
# ${t.name}
${t.desc}

${ii(t)}
  `}function oi(t){let e=t.versions,r=[];return e.bottle&&r.push("bottled"),ke(t)&&r.push("installed"),t.installed.first()?.installed_as_dependency&&r.push("dependency"),`${e.stable} ${r?`(${r.join(", ")})`:""}`}function ii(t){let e="";return t.keg_only&&(e+=`
${t.name} is keg-only, which means it is not symlinked into ${Ot}.
    `),t.caveats&&(e+=`
${t.caveats}
    `),e?`#### Caveats
${e}
    `:""}var d=require("react/jsx-runtime"),Qr=t=>(0,d.jsx)(h.ActionPanel.Section,{children:(0,d.jsx)(h.Action.Push,{target:(0,d.jsx)(h.Detail,{navigationTitle:"Debug Info",markdown:"```json\n"+JSON.stringify(t.obj,null,2)+"\n```",actions:(0,d.jsx)(h.ActionPanel,{children:(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy JSON",content:JSON.stringify(t.obj,null,2)})})}),title:"Debug",icon:h.Icon.MagnifyingGlass})});function Jt(t){let{cask:e}=t,{terminalName:r,terminalIcon:n,runCommandInTerminal:a}=Gt();function s(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[t.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(Yr,{cask:e,isInstalled:t.isInstalled,onAction:t.onAction})}),e.outdated&&(0,d.jsx)(Jr,{formula:e,onAction:t.onAction}),(0,d.jsx)(h.Action.ShowInFinder,{path:zt(e)})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${e.token}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${e.token}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(Gr,{formula:e,onAction:t.onAction}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:Ye(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Uninstall in ${r}`,icon:n,style:h.Action.Style.Destructive,onAction:()=>a(Ye(e))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask Name",content:e.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Tap Name",content:e.tap})]}),(0,d.jsx)(Qr,{obj:e})]})}function o(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[t.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(Yr,{cask:e,isInstalled:t.isInstalled,onAction:t.onAction})}),(0,d.jsx)(qr,{formula:e,onAction:t.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Tap Name",content:e.tap}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask Name",content:e.token,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Install Command",content:Ze(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Install in ${r}`,icon:n,onAction:()=>a(Ze(e))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Cask",url:`https://formulae.brew.sh/cask/${e.token}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Cask URL",content:`https://formulae.brew.sh/cask/${e.token}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]})]})}return ke(t.cask)?s():o()}function Zt(t){let{formula:e}=t,{terminalName:r,terminalIcon:n,runCommandInTerminal:a}=Gt();function s(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[t.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(Xr,{formula:e,isInstalled:t.isInstalled,onAction:t.onAction})}),e.outdated&&(0,d.jsx)(Jr,{formula:e,onAction:t.onAction}),(0,d.jsx)(h.Action.ShowInFinder,{path:zt(e)}),(0,d.jsx)(Oa,{formula:e,onAction:t.onAction}),(0,d.jsx)(Na,{onAction:t.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${e.name}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${e.name}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(Gr,{formula:e,onAction:t.onAction}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Uninstall Command",content:Ye(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Uninstall in ${r}`,style:h.Action.Style.Destructive,icon:n,onAction:()=>a(Ye(e))})]}),(0,d.jsx)(Qr,{obj:e})]})}function o(){return(0,d.jsxs)(h.ActionPanel,{children:[(0,d.jsxs)(h.ActionPanel.Section,{children:[t.showDetails&&(0,d.jsx)(h.Action.Push,{title:"Show Details",icon:h.Icon.Document,target:(0,d.jsx)(Xr,{formula:e,isInstalled:t.isInstalled,onAction:t.onAction})}),(0,d.jsx)(qr,{formula:e,onAction:t.onAction})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula Name",content:e.name,shortcut:{modifiers:["cmd","shift"],key:"c"}}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Install Command",content:Ze(e),shortcut:{modifiers:["cmd","opt"],key:"c"}}),(0,d.jsx)(h.Action,{title:`Run Install in ${r}`,icon:n,onAction:()=>a(Ze(e))})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Formula",url:`https://formulae.brew.sh/formula/${e.name}`}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Formula URL",content:`https://formulae.brew.sh/formula/${e.name}`})]}),(0,d.jsxs)(h.ActionPanel.Section,{children:[(0,d.jsx)(h.Action.OpenInBrowser,{title:"Open Homepage",url:e.homepage}),(0,d.jsx)(h.Action.CopyToClipboard,{title:"Copy Homepage URL",content:e.homepage})]}),(0,d.jsx)(Qr,{obj:e})]})}return ke(t.formula)?s():o()}var K=require("react/jsx-runtime"),Wa={light:"#00000066",dark:"#FFFFFF66"};function za(t){let e=t.formulae,r=t.casks,n=e.length>0||r.length>0;return(0,K.jsxs)(O.List,{searchBarPlaceholder:t.searchBarPlaceholder,searchBarAccessory:t.searchBarAccessory,onSearchTextChange:t.onSearchTextChange,isLoading:t.isLoading,filtering:t.filtering??!0,throttle:!0,children:[!n&&(t.isLoading||!t.dataFetched)&&(0,K.jsx)(O.List.EmptyView,{icon:ct(.5),title:"Loading Packages",description:"Fetching casks and formulae from Homebrew..."}),!n&&!t.isLoading&&t.dataFetched&&(0,K.jsx)(O.List.EmptyView,{icon:O.Icon.MagnifyingGlass,title:"No Results",description:"No packages found"}),e.length>0&&(0,K.jsxs)(O.List.Section,{title:"Formulae",children:[e.map(a=>(0,K.jsx)(ci,{formula:a,isInstalled:t.isInstalled,onAction:t.onAction},`formula-${a.name}`)),e.isTruncated()&&(0,K.jsx)(ja,{})]}),r.length>0&&(0,K.jsxs)(O.List.Section,{title:"Casks",children:[r.map(a=>(0,K.jsx)(li,{cask:a,isInstalled:t.isInstalled,onAction:t.onAction},`cask-${a.token}`)),r.isTruncated()&&(0,K.jsx)(ja,{})]})]})}function ci(t){let e=t.formula,r=e.versions.stable,n=Wa,a,s=O.Icon.Circle;ke(e)&&(r=Ht(e),n=e.outdated?O.Color.Red:O.Color.Green,s=O.Icon.CheckCircle,a=e.outdated?"Outdated":"Up to date");let o={source:s,tintColor:n};return(0,K.jsx)(O.List.Item,{title:e.name,subtitle:e.desc,accessories:[{text:r}],icon:a?{value:o,tooltip:a}:o,actions:(0,K.jsx)(Zt,{formula:e,showDetails:!0,isInstalled:t.isInstalled,onAction:t.onAction})})}function li(t){let e=t.cask,r=e.version,n=Wa,a,s=O.Icon.Circle;ke(e)&&(r=Ht(e),n=e.outdated?O.Color.Red:O.Color.Green,s=O.Icon.CheckCircle,a=e.outdated?"Outdated":"Up to date");let o={source:s,tintColor:n};return(0,K.jsx)(O.List.Item,{title:z(e),subtitle:e.desc,accessories:[{text:r}],icon:a?{value:o,tooltip:a}:o,actions:(0,K.jsx)(Jt,{cask:e,showDetails:!0,isInstalled:t.isInstalled,onAction:t.onAction})})}function ja(){return(0,K.jsx)(O.List.Item,{title:"",icon:O.Icon.Dot})}var pe=require("react/jsx-runtime");function Ga(t){if(t===0)return"0 B";let e=1024,r=["B","KB","MB","GB"],n=Math.floor(Math.log(t)/Math.log(e));return`${(t/Math.pow(e,n)).toFixed(1)} ${r[n]}`}function ot(t){return t.toLocaleString()}function Ha(t,e){if(t.complete)return"";if(e&&t.itemsProcessed>0)return`${ot(t.itemsProcessed)} processed`;if(e)return"Processing...";if(!t.started)return"";if(t.bytesDownloaded>0){let r=Ga(t.bytesDownloaded),n=t.percent>0?Math.min(t.percent,100):0;return n>0?`${n}% downloaded (${r})`:`${r} downloaded`}return"Starting..."}function Ka(t,e,r){return t.complete&&t.totalItems>0?`${ot(t.totalItems)} ${r}`:t.complete?"Done":e&&t.itemsProcessed>0&&t.totalItems>0?`${ot(t.itemsProcessed)} of ${ot(t.totalItems)} ${r}`:e?"Processing...":t.started?t.totalBytes>0?`${Ga(t.totalBytes)} Total`:"Downloading...":"Waiting"}function qa(t,e=!1){if(t.complete)return{source:U.Icon.CheckCircle,tintColor:U.Color.Green};if(e)return ct(.9,U.Color.PrimaryText);if(!t.started)return{source:U.Icon.Circle,tintColor:U.Color.SecondaryText};let r=t.percent>0?Math.min(t.percent,100):0,n=r>0?r/100:.05;return ct(n,U.Color.PrimaryText)}function Ja(){let[t,e]=(0,Ne.useState)(""),[r,n]=(0,Ne.useState)("all"),{isLoading:a,data:s,revalidate:o}=Ta(),{isLoading:i,hasCacheFiles:c,loadingState:u,data:l,indexTotals:f}=Ia({searchText:t,installed:s}),g=r!="casks"?l?.formulae??[]:[],y=r!="formulae"?l?.casks??[]:[],_=(0,Ne.useRef)(!1),m=u.phase;if((0,Ne.useEffect)(()=>{if(m==="complete"&&!_.current&&l){_.current=!0;let b=f?.formulae||0,$=f?.casks||0;(0,U.showToast)({style:U.Toast.Style.Success,title:"Package Index Ready",message:`${ot(b)} formulae and ${ot($)} casks loaded`})}},[m,l]),u.isInitialLoad&&c===null)return(0,pe.jsx)(U.List,{navigationTitle:"Search",searchBarPlaceholder:"Checking cache...",isLoading:!0,children:(0,pe.jsx)(U.List.EmptyView,{icon:U.Icon.MagnifyingGlass,title:"Loading..."})});if(c===!1&&m!=="complete"){let{phase:b,casksProgress:$,formulaeProgress:k}=u,x=$.percent>=100||$.bytesDownloaded>0&&$.totalBytes>0&&$.bytesDownloaded>=$.totalBytes,S=k.percent>=100||k.bytesDownloaded>0&&k.totalBytes>0&&k.bytesDownloaded>=k.totalBytes,p=b==="casks"&&x&&!$.complete,C=b==="formulae"&&S&&!k.complete,M=b==="casks",A="Loading package index...";p?A="Processing casks...":C?A="Processing formulae...":b==="casks"&&$.percent>0?A=`Downloading casks... ${Math.min($.percent,100)}%`:b==="formulae"&&k.percent>0?A=`Downloading formulae... ${Math.min(k.percent,100)}%`:b==="casks"?A="Downloading casks...":b==="formulae"?A="Downloading formulae...":b==="parsing"&&(A="Processing package data...");let it=Ha($,p),ee=M?"":Ha(k,C),B="Download Formulae";C?B="Processing Formulae":!M&&k.started&&(B="Downloading Formulae");let se="Waiting";M?se=p?"Waiting on Casks processing...":"Waiting on Casks to finish...":se=Ka(k,C,"formulae");let xe=M?{source:U.Icon.Circle,tintColor:U.Color.SecondaryText}:qa(k,C);return(0,pe.jsx)(U.List,{navigationTitle:"First-time setup",searchBarPlaceholder:A,isLoading:!0,children:(0,pe.jsxs)(U.List.Section,{title:"Initializing...",children:[(0,pe.jsx)(U.List.Item,{icon:qa($,p),title:p?"Processing Casks":"Downloading Casks",subtitle:it,accessories:[{text:Ka($,p,"casks")}]}),(0,pe.jsx)(U.List.Item,{icon:xe,title:B,subtitle:ee,accessories:[{text:se}]})]})})}return(0,pe.jsx)(za,{formulae:g,casks:y,searchBarPlaceholder:Ma(r),searchBarAccessory:(0,pe.jsx)(Da,{onSelect:n}),isLoading:a||i,onSearchTextChange:b=>e(b.trim()),filtering:!1,isInstalled:b=>Fa(b,s),onAction:()=>o(),dataFetched:u.phase==="complete"})}
