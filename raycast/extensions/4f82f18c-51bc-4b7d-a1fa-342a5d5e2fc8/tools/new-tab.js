"use strict";var Z=Object.create;var m=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var K=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var Y=(r,t)=>{for(var e in t)m(r,e,{get:t[e],enumerable:!0})},R=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of K(t))!q.call(r,a)&&a!==e&&m(r,a,{get:()=>t[a],enumerable:!(n=H(t,a))||n.enumerable});return r};var y=(r,t,e)=>(e=r!=null?Z(J(r)):{},R(t||!r||!r.__esModule?m(e,"default",{value:r,enumerable:!0}):e,r)),Q=r=>R(m({},"__esModule",{value:!0}),r);var fe={};Y(fe,{default:()=>ue});module.exports=Q(fe);var g=require("@raycast/api");var f=y(require("react")),o=require("@raycast/api");var U=y(require("node:child_process")),I=require("node:buffer"),h=y(require("node:stream")),O=require("node:util");var D=require("react/jsx-runtime");var w=globalThis;var b=r=>!!r&&typeof r=="object"&&typeof r.removeListener=="function"&&typeof r.emit=="function"&&typeof r.reallyExit=="function"&&typeof r.listeners=="function"&&typeof r.kill=="function"&&typeof r.pid=="number"&&typeof r.on=="function",k=Symbol.for("signal-exit emitter"),v=class{constructor(){if(this.emitted={afterExit:!1,exit:!1},this.listeners={afterExit:[],exit:[]},this.count=0,this.id=Math.random(),w[k])return w[k];Object.defineProperty(w,k,{value:this,writable:!1,enumerable:!1,configurable:!1})}on(t,e){this.listeners[t].push(e)}removeListener(t,e){let n=this.listeners[t],a=n.indexOf(e);a!==-1&&(a===0&&n.length===1?n.length=0:n.splice(a,1))}emit(t,e,n){if(this.emitted[t])return!1;this.emitted[t]=!0;let a=!1;for(let s of this.listeners[t])a=s(e,n)===!0||a;return t==="exit"&&(a=this.emit("afterExit",e,n)||a),a}},S=class{onExit(){return()=>{}}load(){}unload(){}},E=class{#o;#t;#e;#s;#i;#a;#n;#r;constructor(t){this.#o=process.platform==="win32"?"SIGINT":"SIGHUP",this.#t=new v,this.#a={},this.#n=!1,this.#r=[],this.#r.push("SIGHUP","SIGINT","SIGTERM"),globalThis.process.platform!=="win32"&&this.#r.push("SIGALRM","SIGABRT","SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT"),globalThis.process.platform==="linux"&&this.#r.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT"),this.#e=t,this.#a={};for(let e of this.#r)this.#a[e]=()=>{let n=this.#e.listeners(e),{count:a}=this.#t,s=t;if(typeof s.__signal_exit_emitter__=="object"&&typeof s.__signal_exit_emitter__.count=="number"&&(a+=s.__signal_exit_emitter__.count),n.length===a){this.unload();let i=this.#t.emit("exit",null,e),c=e==="SIGHUP"?this.#o:e;i||t.kill(t.pid,c)}};this.#i=t.reallyExit,this.#s=t.emit}onExit(t,e){if(!b(this.#e))return()=>{};this.#n===!1&&this.load();let n=e?.alwaysLast?"afterExit":"exit";return this.#t.on(n,t),()=>{this.#t.removeListener(n,t),this.#t.listeners.exit.length===0&&this.#t.listeners.afterExit.length===0&&this.unload()}}load(){if(!this.#n){this.#n=!0,this.#t.count+=1;for(let t of this.#r)try{let e=this.#a[t];e&&this.#e.on(t,e)}catch{}this.#e.emit=(t,...e)=>this.#l(t,...e),this.#e.reallyExit=t=>this.#c(t)}}unload(){this.#n&&(this.#n=!1,this.#r.forEach(t=>{let e=this.#a[t];if(!e)throw new Error("Listener not defined for signal: "+t);try{this.#e.removeListener(t,e)}catch{}}),this.#e.emit=this.#s,this.#e.reallyExit=this.#i,this.#t.count-=1)}#c(t){return b(this.#e)?(this.#e.exitCode=t||0,this.#t.emit("exit",this.#e.exitCode,null),this.#i.call(this.#e,this.#e.exitCode)):0}#l(t,...e){let n=this.#s;if(t==="exit"&&b(this.#e)){typeof e[0]=="number"&&(this.#e.exitCode=e[0]);let a=n.call(this.#e,t,...e);return this.#t.emit("exit",this.#e.exitCode,null),a}else return n.call(this.#e,t,...e)}},x=null,X=(r,t)=>(x||(x=b(process)?new E(process):new S),x.onExit(r,t));function ee(r,{timeout:t}={}){let e=new Promise((c,l)=>{r.on("exit",(u,d)=>{c({exitCode:u,signal:d,timedOut:!1})}),r.on("error",u=>{l(u)}),r.stdin&&r.stdin.on("error",u=>{l(u)})}),n=X(()=>{r.kill()});if(t===0||t===void 0)return e.finally(()=>n());let a,s=new Promise((c,l)=>{a=setTimeout(()=>{r.kill("SIGTERM"),l(Object.assign(new Error("Timed out"),{timedOut:!0,signal:"SIGTERM"}))},t)}),i=e.finally(()=>{clearTimeout(a)});return Promise.race([s,i]).finally(()=>n())}var A=class extends Error{constructor(){super("The output is too big"),this.name="MaxBufferError"}};function te(r){let{encoding:t}=r,e=t==="buffer",n=new h.default.PassThrough({objectMode:!1});t&&t!=="buffer"&&n.setEncoding(t);let a=0,s=[];return n.on("data",i=>{s.push(i),a+=i.length}),n.getBufferedValue=()=>e?Buffer.concat(s,a):s.join(""),n.getBufferedLength=()=>a,n}async function _(r,t){let e=te(t);return await new Promise((n,a)=>{let s=i=>{i&&e.getBufferedLength()<=I.constants.MAX_LENGTH&&(i.bufferedData=e.getBufferedValue()),a(i)};(async()=>{try{await(0,O.promisify)(h.default.pipeline)(r,e),n()}catch(i){s(i)}})(),e.on("data",()=>{e.getBufferedLength()>8e7&&s(new A)})}),e.getBufferedValue()}async function T(r,t){r.destroy();try{return await t}catch(e){return e.bufferedData}}async function re({stdout:r,stderr:t},{encoding:e},n){let a=_(r,{encoding:e}),s=_(t,{encoding:e});try{return await Promise.all([n,a,s])}catch(i){return Promise.all([{error:i,exitCode:null,signal:i.signal,timedOut:i.timedOut||!1},T(r,a),T(t,s)])}}function ne(r){let t=typeof r=="string"?`
`:10,e=typeof r=="string"?"\r":13;return r[r.length-1]===t&&(r=r.slice(0,-1)),r[r.length-1]===e&&(r=r.slice(0,-1)),r}function C(r,t){return r.stripFinalNewline?ne(t):t}function ae({timedOut:r,timeout:t,signal:e,exitCode:n}){return r?`timed out after ${t} milliseconds`:e!=null?`was killed with ${e}`:n!=null?`failed with exit code ${n}`:"failed"}function se({stdout:r,stderr:t,error:e,signal:n,exitCode:a,command:s,timedOut:i,options:c,parentError:l}){let d=`Command ${ae({timedOut:i,timeout:c?.timeout,signal:n,exitCode:a})}: ${s}`,p=e?`${d}
${e.message}`:d,$=[p,t,r].filter(Boolean).join(`
`);return e?e.originalMessage=e.message:e=l,e.message=$,e.shortMessage=p,e.command=s,e.exitCode=a,e.signal=n,e.stdout=r,e.stderr=t,"bufferedData"in e&&delete e.bufferedData,e}function ie({stdout:r,stderr:t,error:e,exitCode:n,signal:a,timedOut:s,command:i,options:c,parentError:l}){if(e||n!==0||a!==null)throw se({error:e,exitCode:n,signal:a,stdout:r,stderr:t,command:i,timedOut:s,options:c,parentError:l});return r}async function L(r,t,e){if(process.platform!=="darwin")throw new Error("AppleScript is only supported on macOS");let{humanReadableOutput:n,language:a,timeout:s,...i}=Array.isArray(t)?e||{}:t||{},c=n!==!1?[]:["-ss"];a==="JavaScript"&&c.push("-l","JavaScript"),Array.isArray(t)&&c.push("-",...t);let l=U.default.spawn("osascript",c,{...i,env:{PATH:"/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin"}}),u=ee(l,{timeout:s??1e4});l.stdin.end(r);let[{error:d,exitCode:p,signal:$,timedOut:W},V,F]=await re(l,{encoding:"utf8"},u),B=C({stripFinalNewline:!0},V),G=C({stripFinalNewline:!0},F);return ie({stdout:B,stderr:G,error:d,exitCode:p,signal:$,timedOut:W,command:"osascript",options:e,parentError:new Error})}var M={default:"",google:"https://google.com/search?q=",bing:"https://www.bing.com/search?q=",baidu:"https://www.baidu.com/s?wd=",brave:"https://search.brave.com/search?q=",duckduckgo:"https://duckduckgo.com/?q=",qwant:"https://www.qwant.com/?q=",kagi:"https://kagi.com/search?q="},P="https://cdn.jsdelivr.net/gh/zen-browser/branding/Main%20icons/SVG/zen-black.svg",ge=`
  # \u{1F6A8}Error: Zen Browser is not installed

  ## This extension depends on Zen browser. You must install it to continue.

  If you have [Homebrew](https://brew.sh/) installed then press \u23CE (Enter Key) to install Zen browser.
  [Click here](https://zen-browser.app/download) if you want to download manually.

  > **Note:** If Zen Browser is already installed but you're seeing this message,
  > you may need to adjust the profile configuration in the extension settings. You
  > can find your profile names by visiting \`about:profiles\` in Zen Browser.

  [![Zen Browser](${P})]()
`,$e=`
# \u{1F6A8}Error: Zen browser has no bookmarks. Please add some bookmarks to continue using this command.

[![Zen Browser](${P})]()
`,ye=`
# \u{1F6A8}Error: Something happened while trying to run your command

[![Zen Browser](${P})]()
`;var z=require("@raycast/api");var N=()=>{let r=(0,z.getPreferenceValues)(),e=`keystroke "${r.newTabShortcut.trim().charAt(r.newTabShortcut.length-1).toLowerCase()}" using `,n=oe(r.newTabShortcut);return e+n},oe=r=>r?r.includes("hyper")?"{command down, option down, control down, shift down}":"{"+Object.entries({cmd:"command",command:"command",ctrl:"control",control:"control",opt:"option",option:"option",shift:"shift",alt:"option",super:"command"}).filter(([n])=>r.includes(n)).map(([,n])=>`${n} down`).join(", ")+"}":"{command down}";function ce(r=!1){return[r?'tell application "Raycast" to activate':null,'tell application "Zen" to activate','tell application "System Events"',"  repeat 10 times",'    if frontmost of process "Zen" then exit repeat',"    delay 0.1","  end repeat","end tell"].filter(e=>!!e).join(`
`)}async function j(r){await g.Clipboard.copy(`${M[(0,g.getPreferenceValues)().searchEngine.toLowerCase()]}${r}`);let t=[ce(!0),'tell application "System Events"',`  ${N()}`,"  delay 0.1",'  keystroke "a" using {command down}',"  key code 51",'  keystroke "v" using {command down}',"  key code 36","end tell"].join(`
`);await L(t)}var le=async({searchText:r})=>{await j(r||"")},ue=le;
